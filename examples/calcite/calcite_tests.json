[
{
  "name": "testReduceCastTimeUnchanged",
  "q1": "SELECT CAST(TIME '12:34:56' AS TIMESTAMP(0)) FROM EMP AS EMP",
  "q2": "SELECT CAST(TIME '12:34:56' AS TIMESTAMP(0)) FROM EMP AS EMP0"
},
{
  "name": "testIntersectToDistinct",
  "q1": "SELECT * FROM (SELECT * FROM EMP AS EMP WHERE EMP.DEPTNO = 10 INTERSECT SELECT * FROM EMP AS EMP0 WHERE EMP0.DEPTNO = 20) AS t1 INTERSECT SELECT * FROM EMP AS EMP1 WHERE EMP1.DEPTNO = 30",
  "q2": "SELECT t10.EMPNO, t10.ENAME, t10.JOB, t10.MGR, t10.HIREDATE, t10.SAL, t10.COMM, t10.DEPTNO, t10.SLACKER FROM (SELECT EMP2.EMPNO, EMP2.ENAME, EMP2.JOB, EMP2.MGR, EMP2.HIREDATE, EMP2.SAL, EMP2.COMM, EMP2.DEPTNO, EMP2.SLACKER, COUNT(*) AS $f9 FROM EMP AS EMP2 WHERE EMP2.DEPTNO = 10 GROUP BY EMP2.EMPNO, EMP2.ENAME, EMP2.JOB, EMP2.MGR, EMP2.HIREDATE, EMP2.SAL, EMP2.COMM, EMP2.DEPTNO, EMP2.SLACKER UNION ALL SELECT EMP3.EMPNO, EMP3.ENAME, EMP3.JOB, EMP3.MGR, EMP3.HIREDATE, EMP3.SAL, EMP3.COMM, EMP3.DEPTNO, EMP3.SLACKER, COUNT(*) AS $f9 FROM EMP AS EMP3 WHERE EMP3.DEPTNO = 20 GROUP BY EMP3.EMPNO, EMP3.ENAME, EMP3.JOB, EMP3.MGR, EMP3.HIREDATE, EMP3.SAL, EMP3.COMM, EMP3.DEPTNO, EMP3.SLACKER UNION ALL SELECT EMP4.EMPNO, EMP4.ENAME, EMP4.JOB, EMP4.MGR, EMP4.HIREDATE, EMP4.SAL, EMP4.COMM, EMP4.DEPTNO, EMP4.SLACKER, COUNT(*) AS $f9 FROM EMP AS EMP4 WHERE EMP4.DEPTNO = 30 GROUP BY EMP4.EMPNO, EMP4.ENAME, EMP4.JOB, EMP4.MGR, EMP4.HIREDATE, EMP4.SAL, EMP4.COMM, EMP4.DEPTNO, EMP4.SLACKER) AS t10 GROUP BY t10.EMPNO, t10.ENAME, t10.JOB, t10.MGR, t10.HIREDATE, t10.SAL, t10.COMM, t10.DEPTNO, t10.SLACKER HAVING COUNT(*) = 3"
},
{
  "name": "testEmptyProject2",
  "q1": "SELECT t0.EXPR$0 + t0.EXPR$1 + t0.EXPR$0 FROM (VALUES  (10, 1),  (30, 3)) AS t WHERE t.EXPR$0 + t.EXPR$1 > 50",
  "q2": "SELECT * FROM (VALUES) AS t3"
},
{
  "name": "testEmptyFilterProjectUnion",
  "q1": "SELECT * FROM (SELECT * FROM (VALUES  (10, 1),  (30, 3)) AS t UNION ALL SELECT * FROM (VALUES  (20, 2)) AS t0) AS t1 WHERE t1.X + t1.Y > 30",
  "q2": "SELECT * FROM (VALUES  (30, 3)) AS t3"
},
{
  "name": "testSortProjectTranspose1",
  "q1": "SELECT DEPT.DEPTNO, CAST(DEPT.DEPTNO AS INTEGER) FROM DEPT AS DEPT ORDER BY CAST(DEPT.DEPTNO AS INTEGER) OFFSET 1 ROWS",
  "q2": "SELECT t3.DEPTNO, CAST(t3.DEPTNO AS INTEGER) FROM (SELECT * FROM DEPT AS DEPT0 ORDER BY DEPT0.DEPTNO OFFSET 1 ROWS) AS t3"
},
{
  "name": "testSortProjectTranspose2",
  "q1": "SELECT DEPT.DEPTNO, CAST(DEPT.DEPTNO AS DOUBLE) FROM DEPT AS DEPT ORDER BY CAST(DEPT.DEPTNO AS DOUBLE) OFFSET 1 ROWS",
  "q2": "SELECT t3.DEPTNO, CAST(t3.DEPTNO AS DOUBLE) FROM (SELECT * FROM DEPT AS DEPT0 ORDER BY DEPT0.DEPTNO OFFSET 1 ROWS) AS t3"
},
{
  "name": "testSortProjectTranspose3",
  "q1": "SELECT DEPT.DEPTNO, CAST(DEPT.DEPTNO AS VARCHAR(10)) FROM DEPT AS DEPT ORDER BY CAST(DEPT.DEPTNO AS VARCHAR(10)) OFFSET 1 ROWS",
  "q2": "SELECT DEPT0.DEPTNO, CAST(DEPT0.DEPTNO AS VARCHAR(10)) FROM DEPT AS DEPT0 ORDER BY CAST(DEPT0.DEPTNO AS VARCHAR(10)) OFFSET 1 ROWS"
},
{
  "name": "testPullNull",
  "q1": "SELECT * FROM EMP AS EMP WHERE EMP.DEPTNO = 7 AND EMP.EMPNO = 10 AND EMP.MGR IS NULL AND EMP.EMPNO = 10",
  "q2": "SELECT 10 AS EMPNO, EMP0.ENAME, EMP0.JOB, NULL AS MGR, EMP0.HIREDATE, EMP0.SAL, EMP0.COMM, 7 AS DEPTNO, EMP0.SLACKER FROM EMP AS EMP0 WHERE EMP0.DEPTNO = 7 AND EMP0.MGR IS NULL AND EMP0.EMPNO = 10"
},
{
  "name": "testReduceCastAndConsts",
  "q1": "SELECT * FROM EMP AS EMP WHERE CAST(EMP.EMPNO + 10 / 2 AS INTEGER) = 13",
  "q2": "SELECT * FROM EMP AS EMP0 WHERE EMP0.EMPNO + 5 = 13"
},
{
  "name": "testPushSemiJoinPastJoinRuleRight",
  "q1": "SELECT EMP.ENAME FROM EMP AS EMP, DEPT AS DEPT, EMP AS EMP0 WHERE EMP.DEPTNO = DEPT.DEPTNO AND DEPT.DEPTNO = EMP0.DEPTNO",
  "q2": "SELECT EMP1.ENAME FROM EMP AS EMP1 INNER JOIN DEPT AS DEPT0 ON EMP1.DEPTNO = DEPT0.DEPTNO INNER JOIN (DEPT AS DEPT1 INNER JOIN EMP AS EMP2 ON DEPT1.DEPTNO = EMP2.DEPTNO) ON EMP1.DEPTNO = DEPT1.DEPTNO INNER JOIN EMP AS EMP3 ON DEPT0.DEPTNO = EMP3.DEPTNO"
},
{
  "name": "basePushAggThroughUnion",
  "q1": "SELECT t.ENAME, COUNT(t.MGR) FROM (SELECT * FROM EMP AS EMP UNION ALL SELECT * FROM EMP AS EMP0) AS t GROUP BY t.ENAME",
  "q2": "SELECT t6.ENAME, SUM(COUNT(EMP2.MGR)) FROM (SELECT EMP1.ENAME, COUNT(EMP1.MGR) FROM EMP AS EMP1 GROUP BY EMP1.ENAME UNION ALL SELECT EMP2.ENAME, COUNT(EMP2.MGR) FROM EMP AS EMP2 GROUP BY EMP2.ENAME) AS t6 GROUP BY t6.ENAME"
},
{
  "name": "testEmptyAggregateEmptyKeyWithAggregateValuesRule",
  "q1": "SELECT COUNT(*), SUM(t.EMPNO) FROM (VALUES) AS t",
  "q2": "SELECT * FROM (VALUES  (0, NULL)) AS t1"
},
{
  "name": "basePullConstantTroughAggregate",
  "q1": "SELECT 4, 2 + 3, MAX(5) FROM EMP AS EMP GROUP BY 4, 2 + 3",
  "q2": "SELECT 4, 2 + 3, MAX(5) FROM EMP AS EMP0 GROUP BY 4"
},
{
  "name": "testReduceValuesUnderProjectFilter",
  "q1": "SELECT t0.EXPR$0 + t0.EXPR$1 AS X, t0.EXPR$1 AS B, t0.EXPR$0 AS A FROM (VALUES  (10, 1),  (30, 7),  (20, 3)) AS t WHERE t.EXPR$0 - t.EXPR$1 < 21",
  "q2": "SELECT * FROM (VALUES  (11, 1, 10),  (23, 3, 20)) AS t2"
},
{
  "name": "testMergeMinus",
  "q1": "SELECT * FROM (SELECT * FROM EMP AS EMP WHERE EMP.DEPTNO = 10 EXCEPT SELECT * FROM EMP AS EMP0 WHERE EMP0.DEPTNO = 20) AS t1 EXCEPT SELECT * FROM EMP AS EMP1 WHERE EMP1.DEPTNO = 30",
  "q2": "SELECT * FROM EMP AS EMP2 WHERE EMP2.DEPTNO = 10 EXCEPT SELECT * FROM EMP AS EMP3 WHERE EMP3.DEPTNO = 20 EXCEPT SELECT * FROM EMP AS EMP4 WHERE EMP4.DEPTNO = 30"
},
{
  "name": "testDecorrelateTwoExists",
  "q1": "SELECT * FROM EMP AS EMP WHERE EXISTS (SELECT * FROM EMP AS EMP0 WHERE EMP.DEPTNO = EMP0.DEPTNO) AND NOT EXISTS (SELECT * FROM EMP AS EMP1 WHERE EMP1.JOB = EMP.JOB AND EMP1.SAL = 34)",
  "q2": "SELECT EMP2.EMPNO, EMP2.ENAME, EMP2.JOB, EMP2.MGR, EMP2.HIREDATE, EMP2.SAL, EMP2.COMM, EMP2.DEPTNO, EMP2.SLACKER FROM EMP AS EMP2 INNER JOIN (SELECT EMP3.DEPTNO, TRUE AS $f1 FROM EMP AS EMP3 GROUP BY EMP3.DEPTNO) AS t5 ON EMP2.DEPTNO = t5.DEPTNO LEFT JOIN (SELECT EMP4.JOB, TRUE AS $f1 FROM EMP AS EMP4 WHERE EMP4.SAL = 34 GROUP BY EMP4.JOB) AS t10 ON EMP2.JOB = t10.JOB WHERE t10.$f1 IS NULL"
},
{
  "name": "testEmptyMinus",
  "q1": "SELECT * FROM (SELECT * FROM (VALUES  (30, 3)) AS t WHERE t.EXPR$0 > 30 EXCEPT SELECT * FROM (VALUES  (20, 2)) AS t1) AS t2 EXCEPT SELECT * FROM (VALUES  (40, 4)) AS t3",
  "q2": "SELECT * FROM (VALUES) AS t5"
},
{
  "name": "testReduceValuesUnderProject",
  "q1": "SELECT t.EXPR$0 + t.EXPR$1 FROM (VALUES  (10, 1),  (20, 3)) AS t",
  "q2": "SELECT * FROM (VALUES  (11),  (23)) AS t1"
},
{
  "name": "testAggregateConstantKeyRule",
  "q1": "SELECT COUNT(*) AS C FROM EMP AS EMP WHERE EMP.DEPTNO = 10 GROUP BY EMP.DEPTNO, EMP.SAL",
  "q2": "SELECT COUNT(*) AS C FROM EMP AS EMP0 WHERE EMP0.DEPTNO = 10 GROUP BY EMP0.SAL"
},
{
  "name": "testExpandFilterExistsSimpleAnd",
  "q1": "SELECT EMP.EMPNO FROM EMP AS EMP WHERE EXISTS (SELECT * FROM EMP AS EMP0 WHERE EMP0.EMPNO < 20) AND EMP.SAL < 100",
  "q2": "SELECT EMP1.EMPNO FROM EMP AS EMP1, (SELECT TRUE AS i FROM EMP AS EMP2 WHERE EMP2.EMPNO < 20 GROUP BY TRUE) AS t4 WHERE EMP1.SAL < 100"
},
{
  "name": "testReduceValuesUnderFilter",
  "q1": "SELECT * FROM (VALUES  (10, 'x'),  (20, 'y')) AS t WHERE t.EXPR$0 < 15",
  "q2": "SELECT * FROM (VALUES  (10, 'x')) AS t1"
},
{
  "name": "testReduceConstantsDup",
  "q1": "SELECT DEPT.DEPTNO FROM DEPT AS DEPT WHERE DEPT.DEPTNO = 7 AND DEPT.DEPTNO = 8",
  "q2": "SELECT t1.DEPTNO FROM (VALUES) AS t1"
},
{
  "name": "testAggregateProjectMerge",
  "q1": "SELECT EMP.DEPTNO AS X, SUM(EMP.SAL), EMP.EMPNO AS Y FROM EMP AS EMP GROUP BY EMP.DEPTNO, EMP.EMPNO",
  "q2": "SELECT EMP0.DEPTNO AS X, SUM(EMP0.SAL), EMP0.EMPNO AS Y FROM EMP AS EMP0 GROUP BY EMP0.EMPNO, EMP0.DEPTNO"
},
{
  "name": "testRemoveSemiJoin",
  "q1": "SELECT EMP.ENAME FROM EMP AS EMP, DEPT AS DEPT WHERE EMP.DEPTNO = DEPT.DEPTNO",
  "q2": "SELECT EMP0.ENAME FROM EMP AS EMP0 INNER JOIN DEPT AS DEPT0 ON EMP0.DEPTNO = DEPT0.DEPTNO"
},
{
  "name": "testPullConstantThroughUnion",
  "q1": "SELECT 2, EMP.DEPTNO, EMP.JOB FROM EMP AS EMP UNION ALL SELECT 2, EMP0.DEPTNO, EMP0.JOB FROM EMP AS EMP0",
  "q2": "SELECT 2, t6.DEPTNO, t6.JOB FROM (SELECT EMP1.DEPTNO, EMP1.JOB FROM EMP AS EMP1 UNION ALL SELECT EMP2.DEPTNO, EMP2.JOB FROM EMP AS EMP2) AS t6"
},
{
  "name": "testWhereNotInCorrelated2",
  "q1": "SELECT * FROM EMP AS EMP WHERE EMP.EMPNO NOT IN (SELECT t0.EMPNO FROM (SELECT EMP0.ENAME, EMP0.EMPNO, EMP0.SAL AS R FROM EMP AS EMP0) AS t WHERE t.R > 2 AND EMP.ENAME = t.ENAME)",
  "q2": "SELECT EMP1.EMPNO, EMP1.ENAME, EMP1.JOB, EMP1.MGR, EMP1.HIREDATE, EMP1.SAL, EMP1.COMM, EMP1.DEPTNO, EMP1.SLACKER FROM EMP AS EMP1 LEFT JOIN (SELECT t4.ENAME, COUNT(*) AS c, COUNT(t4.EMPNO) AS ck FROM (SELECT EMP2.ENAME, EMP2.EMPNO, EMP2.SAL AS R FROM EMP AS EMP2) AS t3 WHERE t3.R > 2 GROUP BY t4.ENAME) AS t7 ON EMP1.ENAME = t7.ENAME LEFT JOIN (SELECT t9.EMPNO, TRUE AS i, t9.ENAME FROM (SELECT EMP3.ENAME, EMP3.EMPNO, EMP3.SAL AS R FROM EMP AS EMP3) AS t8 WHERE t8.R > 2) AS t11 ON EMP1.EMPNO = t11.EMPNO AND EMP1.ENAME = t11.ENAME WHERE NOT CASE WHEN t7.c = 0 THEN FALSE WHEN t11.i IS NOT NULL THEN TRUE WHEN t7.ck < t7.c THEN TRUE ELSE FALSE END"
},
{
  "name": "testReduceNot",
  "q1": "SELECT * FROM (SELECT CASE WHEN EMP.SAL > 1000 THEN NULL ELSE FALSE END AS CASECOL FROM EMP AS EMP) AS t WHERE NOT t.CASECOL",
  "q2": "SELECT * FROM (SELECT CASE WHEN EMP0.SAL > 1000 THEN NULL ELSE FALSE END AS CASECOL FROM EMP AS EMP0) AS t1 WHERE NOT t1.CASECOL"
},
{
  "name": "testDistinctWithGrouping",
  "q1": "SELECT EMP.SAL, SUM(EMP.COMM), MIN(EMP.COMM), SUM(DISTINCT EMP.SAL) FROM EMP AS EMP GROUP BY EMP.SAL",
  "q2": "SELECT t2.SAL, SUM(SUM(EMP0.COMM)), MIN(MIN(EMP0.COMM)), SUM(t2.SAL) FROM (SELECT EMP0.SAL, SUM(EMP0.COMM), MIN(EMP0.COMM) FROM EMP AS EMP0 GROUP BY EMP0.SAL) AS t2 GROUP BY t2.SAL"
},
{
  "name": "testWhereNotInCorrelated",
  "q1": "SELECT EMP.SAL FROM EMP AS EMP WHERE EMP.EMPNO NOT IN (SELECT DEPT.DEPTNO FROM DEPT AS DEPT WHERE EMP.JOB = DEPT.NAME)",
  "q2": "SELECT EMP0.SAL FROM EMP AS EMP0 LEFT JOIN (SELECT DEPT0.NAME, COUNT(*) AS c, COUNT(DEPT0.DEPTNO) AS ck FROM DEPT AS DEPT0 GROUP BY DEPT0.NAME) AS t4 ON EMP0.JOB = t4.NAME LEFT JOIN (SELECT DEPT1.DEPTNO, TRUE AS i, DEPT1.NAME FROM DEPT AS DEPT1) AS t5 ON EMP0.EMPNO = t5.DEPTNO AND EMP0.JOB = t5.NAME WHERE NOT CASE WHEN t4.c = 0 THEN FALSE WHEN t5.i IS NOT NULL THEN TRUE WHEN t4.ck < t4.c THEN TRUE ELSE FALSE END"
},
{
  "name": "testMinusMergeRule",
  "q1": "SELECT * FROM (SELECT t2.NAME, t2.DEPTNO FROM (SELECT DEPT.NAME, DEPT.DEPTNO, COUNT(*) FROM DEPT AS DEPT GROUP BY DEPT.NAME, DEPT.DEPTNO EXCEPT ALL SELECT DEPT0.NAME, DEPT0.DEPTNO, 1 FROM DEPT AS DEPT0) AS t2 EXCEPT ALL SELECT t7.NAME, t7.DEPTNO FROM (SELECT DEPT1.NAME, DEPT1.DEPTNO, 1 FROM DEPT AS DEPT1 EXCEPT ALL SELECT DEPT2.NAME, DEPT2.DEPTNO, COUNT(*) FROM DEPT AS DEPT2 GROUP BY DEPT2.NAME, DEPT2.DEPTNO) AS t7) AS t9 EXCEPT ALL SELECT DEPT3.NAME, DEPT3.DEPTNO FROM DEPT AS DEPT3",
  "q2": "SELECT DEPT4.NAME, DEPT4.DEPTNO FROM DEPT AS DEPT4 GROUP BY DEPT4.NAME, DEPT4.DEPTNO EXCEPT ALL SELECT DEPT5.NAME, DEPT5.DEPTNO FROM DEPT AS DEPT5 EXCEPT ALL SELECT * FROM (SELECT DEPT6.NAME, DEPT6.DEPTNO FROM DEPT AS DEPT6 EXCEPT ALL SELECT DEPT7.NAME, DEPT7.DEPTNO FROM DEPT AS DEPT7 GROUP BY DEPT7.NAME, DEPT7.DEPTNO) AS t22 EXCEPT ALL SELECT DEPT8.NAME, DEPT8.DEPTNO FROM DEPT AS DEPT8"
},
{
  "name": "testWhereInCorrelated",
  "q1": "SELECT EMP.SAL FROM EMP AS EMP WHERE EMP.EMPNO IN (SELECT DEPT.DEPTNO FROM DEPT AS DEPT WHERE EMP.JOB = DEPT.NAME)",
  "q2": "SELECT EMP0.SAL FROM EMP AS EMP0 INNER JOIN DEPT AS DEPT0 ON EMP0.JOB = DEPT0.NAME AND EMP0.EMPNO = DEPT0.DEPTNO"
},
{
  "name": "testReduceConstantsNullEqualsOne",
  "q1": "SELECT COUNT(*) FROM EMP AS EMP WHERE NULL = 1",
  "q2": "SELECT COUNT(*) FROM (VALUES) AS t2"
},
{
  "name": "testDistinctCountMultiple",
  "q1": "SELECT EMP.DEPTNO, COUNT(DISTINCT EMP.ENAME), COUNT(DISTINCT EMP.JOB) FROM EMP AS EMP GROUP BY EMP.DEPTNO",
  "q2": "SELECT EMP0.DEPTNO, COUNT(EMP0.ENAME), COUNT(EMP0.JOB) FROM EMP AS EMP0 GROUP BY EMP0.DEPTNO"
},
{
  "name": "testSemiJoinRuleExists",
  "q1": "SELECT DEPT.DEPTNO, DEPT.NAME FROM DEPT AS DEPT INNER JOIN (SELECT EMP.DEPTNO AS DEPTNO9 FROM EMP AS EMP WHERE EMP.SAL > 100 GROUP BY EMP.DEPTNO) AS t1 ON DEPT.DEPTNO = t1.DEPTNO9",
  "q2": "SELECT * FROM DEPT AS DEPT0 INNER JOIN (SELECT EMP0.DEPTNO AS DEPTNO9, TRUE AS $f0 FROM EMP AS EMP0 WHERE EMP0.SAL > 100) AS t4 ON DEPT0.DEPTNO = t4.DEPTNO9"
},
{
  "name": "testWhereExpressionInCorrelated",
  "q1": "SELECT t2.ENAME FROM (SELECT EMP.ENAME, EMP.DEPTNO, EMP.SAL + 1 AS SALPLUS FROM EMP AS EMP) AS t WHERE t.DEPTNO IN (SELECT EMP0.DEPTNO FROM EMP AS EMP0 WHERE EMP0.SAL + 1 = EMP.JOB)",
  "q2": "SELECT t4.ENAME FROM (SELECT EMP1.ENAME, EMP1.DEPTNO, EMP1.SAL + 1 AS SALPLUS FROM EMP AS EMP1) AS t4 INNER JOIN (SELECT t6.DEPTNO, t6.$f9 FROM (SELECT EMP2.EMPNO, EMP2.ENAME, EMP2.JOB, EMP2.MGR, EMP2.HIREDATE, EMP2.SAL, EMP2.COMM, EMP2.DEPTNO, EMP2.SLACKER, EMP2.SAL + 1 AS $f9 FROM EMP AS EMP2) AS t5 WHERE t5.SAL + 1 = t5.$f9 GROUP BY t6.DEPTNO, t6.$f9) AS t8 ON t4.SALPLUS = t8.$f9 AND t4.DEPTNO = t8.DEPTNO"
},
{
  "name": "testExpandFilterInComposite",
  "q1": "SELECT EMP.EMPNO FROM EMP AS EMP WHERE (EMP.EMPNO, EMP.DEPTNO) IN (SELECT EMP0.EMPNO, EMP0.DEPTNO FROM EMP AS EMP0 WHERE EMP0.EMPNO < 20) OR EMP.SAL < 100",
  "q2": "SELECT EMP1.EMPNO FROM EMP AS EMP1 LEFT JOIN (SELECT EMP2.EMPNO, EMP2.DEPTNO, TRUE AS i FROM EMP AS EMP2 WHERE EMP2.EMPNO < 20) AS t5 ON EMP1.EMPNO = t5.EMPNO AND EMP1.DEPTNO = t5.DEPTNO WHERE t5.i IS NOT NULL OR EMP1.SAL < 100"
},
{
  "name": "testPullFilterThroughAggregateGroupingSets",
  "q1": "SELECT t0.ENAME, t0.SAL, t0.DEPTNO FROM (SELECT EMP.ENAME, EMP.SAL, EMP.DEPTNO FROM EMP AS EMP) AS t WHERE t.SAL > 5000 GROUP BY t0.ENAME, t0.SAL, t0.DEPTNO",
  "q2": "SELECT t4.ENAME, t4.SAL, t4.DEPTNO FROM (SELECT EMP0.ENAME, EMP0.SAL, EMP0.DEPTNO FROM EMP AS EMP0 GROUP BY EMP0.ENAME, EMP0.SAL, EMP0.DEPTNO HAVING EMP0.SAL > 5000) AS t4 GROUP BY t4.ENAME, t4.SAL, t4.DEPTNO"
},
{
  "name": "testReduceConstantsRequiresExecutor",
  "q1": "SELECT * FROM (VALUES  (1, 2)) AS t WHERE 1 + 2 > 3 + NULL",
  "q2": "SELECT * FROM (VALUES  (1, 2)) AS t1 WHERE 1 + 2 > 3 + NULL"
},
{
  "name": "testTransitiveInferenceJoin3wayAgg",
  "q1": "SELECT 1 FROM (SELECT EMP.DEPTNO, COUNT(*) FROM EMP AS EMP WHERE EMP.DEPTNO > 7 GROUP BY EMP.DEPTNO) AS t1 INNER JOIN EMP AS EMP0 ON t1.DEPTNO = EMP0.DEPTNO INNER JOIN EMP AS EMP1 ON EMP0.DEPTNO = EMP1.DEPTNO",
  "q2": "SELECT 1 FROM (SELECT EMP2.DEPTNO, COUNT(*) FROM EMP AS EMP2 WHERE EMP2.DEPTNO > 7 GROUP BY EMP2.DEPTNO) AS t5 INNER JOIN (SELECT * FROM EMP AS EMP3 WHERE EMP3.DEPTNO > 7) AS t6 ON t5.DEPTNO = t6.DEPTNO INNER JOIN (SELECT * FROM EMP AS EMP4 WHERE EMP4.DEPTNO > 7) AS t7 ON t6.DEPTNO = t7.DEPTNO"
},
{
  "name": "testReduceConstantsProjectNullable",
  "q1": "SELECT EMP.MGR FROM EMP AS EMP WHERE EMP.MGR = 10",
  "q2": "SELECT CAST(10 AS INTEGER) AS MGR FROM EMP AS EMP0 WHERE EMP0.MGR = 10"
},
{
  "name": "testWhereOrSubQuery",
  "q1": "SELECT * FROM EMP AS EMP WHERE EMP.SAL = 4 OR EMP.EMPNO NOT IN (SELECT DEPT.DEPTNO FROM DEPT AS DEPT)",
  "q2": "SELECT EMP0.EMPNO, EMP0.ENAME, EMP0.JOB, EMP0.MGR, EMP0.HIREDATE, EMP0.SAL, EMP0.COMM, EMP0.DEPTNO, EMP0.SLACKER FROM EMP AS EMP0 LEFT JOIN (SELECT DEPT0.DEPTNO, TRUE AS i FROM DEPT AS DEPT0) AS t2 ON EMP0.EMPNO = t2.DEPTNO WHERE EMP0.SAL = 4 OR NOT CASE WHEN t2.i IS NOT NULL THEN TRUE ELSE FALSE END"
},
{
  "name": "testTransitiveInferencePreventProjectPullUp",
  "q1": "SELECT 1 FROM (SELECT EMP.COMM AS DEPTNO FROM EMP AS EMP WHERE EMP.DEPTNO > 7) AS t0 INNER JOIN EMP AS EMP0 ON t0.DEPTNO = EMP0.DEPTNO",
  "q2": "SELECT 1 FROM (SELECT EMP1.COMM AS DEPTNO FROM EMP AS EMP1 WHERE EMP1.DEPTNO > 7) AS t3 INNER JOIN EMP AS EMP2 ON t3.DEPTNO = EMP2.DEPTNO"
},
{
  "name": "testDecorrelateExists",
  "q1": "SELECT * FROM EMP AS EMP WHERE EXISTS (SELECT * FROM EMP AS EMP0 WHERE EMP.DEPTNO = EMP0.DEPTNO)",
  "q2": "SELECT EMP1.EMPNO, EMP1.ENAME, EMP1.JOB, EMP1.MGR, EMP1.HIREDATE, EMP1.SAL, EMP1.COMM, EMP1.DEPTNO, EMP1.SLACKER FROM EMP AS EMP1 INNER JOIN (SELECT EMP2.DEPTNO, TRUE AS $f1 FROM EMP AS EMP2 GROUP BY EMP2.DEPTNO) AS t4 ON EMP1.DEPTNO = t4.DEPTNO"
},
{
  "name": "testTransitiveInferenceJoin3way",
  "q1": "SELECT 1 FROM (SELECT * FROM EMP AS EMP WHERE EMP.DEPTNO > 7) AS t INNER JOIN EMP AS EMP0 ON t.DEPTNO = EMP0.DEPTNO INNER JOIN EMP AS EMP1 ON EMP0.DEPTNO = EMP1.DEPTNO",
  "q2": "SELECT 1 FROM (SELECT * FROM EMP AS EMP2 WHERE EMP2.DEPTNO > 7) AS t1 INNER JOIN (SELECT * FROM EMP AS EMP3 WHERE EMP3.DEPTNO > 7) AS t2 ON t1.DEPTNO = t2.DEPTNO INNER JOIN (SELECT * FROM EMP AS EMP4 WHERE EMP4.DEPTNO > 7) AS t3 ON t2.DEPTNO = t3.DEPTNO"
},
{
  "name": "basePushAggThroughUnion",
  "q1": "SELECT t.ENAME, COUNT(*) FROM (SELECT * FROM EMP AS EMP UNION ALL SELECT * FROM EMP AS EMP0) AS t GROUP BY t.ENAME",
  "q2": "SELECT t6.ENAME, SUM(COUNT(*)) FROM (SELECT EMP1.ENAME, COUNT(*) FROM EMP AS EMP1 GROUP BY EMP1.ENAME UNION ALL SELECT EMP2.ENAME, COUNT(*) FROM EMP AS EMP2 GROUP BY EMP2.ENAME) AS t6 GROUP BY t6.ENAME"
},
{
  "name": "testRemoveSemiJoinRight",
  "q1": "SELECT EMP.ENAME FROM EMP AS EMP, DEPT AS DEPT, EMP AS EMP0 WHERE EMP.DEPTNO = DEPT.DEPTNO AND DEPT.DEPTNO = EMP0.DEPTNO",
  "q2": "SELECT EMP1.ENAME FROM EMP AS EMP1 INNER JOIN DEPT AS DEPT0 ON EMP1.DEPTNO = DEPT0.DEPTNO INNER JOIN EMP AS EMP2 ON DEPT0.DEPTNO = EMP2.DEPTNO"
},
{
  "name": "testCustomColumnResolvingInNonCorrelatedSubQuery",
  "q1": "SELECT * FROM T AS T WHERE T.F0_C0 IN (SELECT T0.F1_C0 AS C0 FROM T AS T0)",
  "q2": "SELECT T1.K0, T1.C1, T1.F1_A0, T1.F2_A0, T1.F0.C0, T1.F1_C0, T1.F0_C1, T1.F1_C2, T1.F2_C3 FROM T AS T1 INNER JOIN (SELECT T2.F1_C0 AS C0 FROM T AS T2 GROUP BY T2.F1_C0) AS t2 ON T1.F0.C0 = t2.C0"
},
{
  "name": "testReduceExpressionsNot",
  "q1": "SELECT * FROM (VALUES  (FALSE),  (TRUE)) AS t WHERE NOT t.EXPR$0",
  "q2": "SELECT * FROM (VALUES  (FALSE),  (TRUE)) AS t1 WHERE NOT t1.EXPR$0"
},
{
  "name": "testPushProjectPastInnerJoin",
  "q1": "SELECT COUNT(*), CASE WHEN EMP.SAL < 11 THEN 11 ELSE -1 * EMP.SAL END FROM EMP AS EMP INNER JOIN BONUS AS BONUS ON EMP.ENAME = BONUS.ENAME GROUP BY CASE WHEN EMP.SAL < 11 THEN 11 ELSE -1 * EMP.SAL END",
  "q2": "SELECT COUNT(*), t2.CASE FROM (SELECT EMP0.ENAME, CASE WHEN EMP0.SAL < 11 THEN 11 ELSE -1 * EMP0.SAL END AS CASE FROM EMP AS EMP0) AS t2 INNER JOIN (SELECT BONUS0.ENAME FROM BONUS AS BONUS0) AS t3 ON t2.ENAME = t3.ENAME GROUP BY t2.CASE"
},
{
  "name": "testPushAggregateFunctionsThroughJoin",
  "q1": "SELECT EMP.JOB, MIN(EMP.SAL) AS MIN_SAL, MIN(EMP.DEPTNO) AS MIN_DEPTNO, SUM(EMP.SAL) + 1 AS SUM_SAL_PLUS, MAX(EMP.SAL) AS MAX_SAL, SUM(EMP.SAL) AS SUM_SAL_2, COUNT(*) AS COUNT_SAL, COUNT(EMP.MGR) AS COUNT_MGR FROM EMP AS EMP INNER JOIN DEPT AS DEPT ON EMP.JOB = DEPT.NAME GROUP BY EMP.JOB, DEPT.NAME",
  "q2": "SELECT t1.JOB, t1.MIN_SAL, t1.MIN_DEPTNO, CAST(t1.SUM_SAL_2 * t2.$f1 AS INTEGER) + 1 AS SUM_SAL_PLUS, t1.MAX_SAL, CAST(t1.SUM_SAL_2 * t2.$f1 AS INTEGER) AS SUM_SAL_2, t1.COUNT_SAL * t2.$f1 AS COUNT_SAL, t1.COUNT_MGR * t2.$f1 AS COUNT_MGR FROM (SELECT EMP0.JOB, MIN(EMP0.SAL) AS MIN_SAL, MIN(EMP0.DEPTNO) AS MIN_DEPTNO, SUM(EMP0.SAL) AS SUM_SAL_2, MAX(EMP0.SAL) AS MAX_SAL, COUNT(*) AS COUNT_SAL, COUNT(EMP0.MGR) AS COUNT_MGR FROM EMP AS EMP0 GROUP BY EMP0.JOB) AS t1 INNER JOIN (SELECT DEPT0.NAME, COUNT(*) AS $f1 FROM DEPT AS DEPT0 GROUP BY DEPT0.NAME) AS t2 ON t1.JOB = t2.NAME"
},
{
  "name": "testTransitiveInferenceProject",
  "q1": "SELECT 1 FROM (SELECT * FROM EMP AS EMP WHERE EMP.DEPTNO > 7) AS t INNER JOIN EMP AS EMP0 ON t.DEPTNO = EMP0.DEPTNO",
  "q2": "SELECT 1 FROM (SELECT * FROM EMP AS EMP1 WHERE EMP1.DEPTNO > 7) AS t1 INNER JOIN (SELECT * FROM EMP AS EMP2 WHERE EMP2.DEPTNO > 7) AS t2 ON t1.DEPTNO = t2.DEPTNO"
},
{
  "name": "basePushAggThroughUnion",
  "q1": "SELECT t.ENAME, AVG(t.EMPNO) FROM (SELECT * FROM EMP AS EMP UNION ALL SELECT * FROM EMP AS EMP0) AS t GROUP BY t.ENAME",
  "q2": "SELECT t4.ENAME, AVG(t4.EMPNO) FROM (SELECT EMP1.ENAME, EMP1.EMPNO FROM EMP AS EMP1 UNION ALL SELECT EMP2.ENAME, EMP2.EMPNO FROM EMP AS EMP2) AS t4 GROUP BY t4.ENAME"
},
{
  "name": "testPushProjectPastFullJoinStrong",
  "q1": "SELECT COUNT(*), CASE WHEN EMP.SAL < 11 THEN -1 * EMP.SAL ELSE EMP.SAL END FROM EMP AS EMP FULL JOIN BONUS AS BONUS ON EMP.ENAME = BONUS.ENAME GROUP BY CASE WHEN EMP.SAL < 11 THEN -1 * EMP.SAL ELSE EMP.SAL END",
  "q2": "SELECT COUNT(*), t2.CASE FROM (SELECT EMP0.ENAME, CASE WHEN EMP0.SAL < 11 THEN -1 * EMP0.SAL ELSE EMP0.SAL END AS CASE FROM EMP AS EMP0) AS t2 FULL JOIN (SELECT BONUS0.ENAME FROM BONUS AS BONUS0) AS t3 ON t2.ENAME = t3.ENAME GROUP BY t2.CASE"
},
{
  "name": "testReduceConstantsCalc",
  "q1": "SELECT * FROM (SELECT UPPER(SUBSTRING(t6.X FROM 1 FOR 2) || SUBSTRING(t6.X FROM 3)) AS U, SUBSTRING(t6.X FROM 1 FOR 1) AS S FROM (SELECT * FROM (SELECT 'table' AS X FROM (VALUES  (TRUE)) AS t UNION SELECT 'view' FROM (VALUES  (TRUE)) AS t1) AS t3 UNION SELECT 'foreign table' FROM (VALUES  (TRUE)) AS t4) AS t6) AS t7 WHERE t7.U = 'TABLE'",
  "q2": "SELECT 'TABLE        ' AS U, 't' AS S FROM (VALUES  (TRUE)) AS t9"
},
{
  "name": "testReduceConstantsDup2",
  "q1": "SELECT * FROM EMP AS EMP WHERE EMP.DEPTNO = 7 AND EMP.DEPTNO = 8 AND EMP.EMPNO = 10 AND EMP.MGR IS NULL AND EMP.EMPNO = 10",
  "q2": "SELECT 10 AS EMPNO, t0.ENAME, t0.JOB, NULL AS MGR, t0.HIREDATE, t0.SAL, t0.COMM, t0.DEPTNO, t0.SLACKER FROM (VALUES) AS t0"
},
{
  "name": "testReduceConstantsNull",
  "q1": "SELECT * FROM (SELECT * FROM (SELECT NULL AS N FROM EMP AS EMP) AS t WHERE t.N IS NULL AND t.N IS NULL) AS t0 WHERE t0.N IS NULL",
  "q2": "SELECT NULL AS N FROM EMP AS EMP0"
},
{
  "name": "basePushAggThroughUnion",
  "q1": "SELECT t1.DEPTNO, COUNT(*) FROM (SELECT * FROM EMP AS EMP WHERE EMP.DEPTNO = 10 UNION ALL SELECT * FROM EMP AS EMP0 WHERE EMP0.DEPTNO > 20) AS t1 GROUP BY t1.DEPTNO",
  "q2": "SELECT t10.DEPTNO, SUM(COUNT(*)) FROM (SELECT EMP1.DEPTNO, COUNT(*) FROM EMP AS EMP1 WHERE EMP1.DEPTNO = 10 GROUP BY EMP1.DEPTNO UNION ALL SELECT EMP2.DEPTNO, COUNT(*) FROM EMP AS EMP2 WHERE EMP2.DEPTNO > 20 GROUP BY EMP2.DEPTNO) AS t10 GROUP BY t10.DEPTNO"
},
{
  "name": "testReduceConstantsNegatedInverted",
  "q1": "SELECT EMP.EMPNO FROM EMP AS EMP WHERE EMP.EMPNO > 10 AND EMP.EMPNO <= 10",
  "q2": "SELECT t1.EMPNO FROM (VALUES) AS t1"
},
{
  "name": "basePushAggThroughUnion",
  "q1": "SELECT t.DEPTNO, t.JOB, SUM(t.EMPNO), COUNT(*), MIN(t.DEPTNO), MAX(t.EMPNO) FROM (SELECT * FROM EMP AS EMP UNION ALL SELECT * FROM EMP AS EMP0) AS t GROUP BY t.DEPTNO, t.JOB",
  "q2": "SELECT t6.DEPTNO, t6.JOB, SUM(SUM(EMP2.EMPNO)), SUM(COUNT(*)), MIN(MIN(EMP2.DEPTNO)), MAX(MAX(EMP2.EMPNO)) FROM (SELECT EMP1.DEPTNO, EMP1.JOB, SUM(EMP1.EMPNO), COUNT(*), MIN(EMP1.DEPTNO), MAX(EMP1.EMPNO) FROM EMP AS EMP1 GROUP BY EMP1.DEPTNO, EMP1.JOB UNION ALL SELECT EMP2.DEPTNO, EMP2.JOB, SUM(EMP2.EMPNO), COUNT(*), MIN(EMP2.DEPTNO), MAX(EMP2.EMPNO) FROM EMP AS EMP2 GROUP BY EMP2.DEPTNO, EMP2.JOB) AS t6 GROUP BY t6.DEPTNO, t6.JOB"
},
{
  "name": "testPushSemiJoinPastJoinRuleLeft",
  "q1": "SELECT EMP.ENAME FROM EMP AS EMP, DEPT AS DEPT, EMP AS EMP0 WHERE EMP.DEPTNO = DEPT.DEPTNO AND EMP.EMPNO = EMP0.EMPNO",
  "q2": "SELECT EMP1.ENAME FROM EMP AS EMP1 INNER JOIN DEPT AS DEPT0 ON EMP1.DEPTNO = DEPT0.DEPTNO INNER JOIN EMP AS EMP2 ON EMP1.EMPNO = EMP2.EMPNO INNER JOIN DEPT AS DEPT1 ON EMP1.DEPTNO = DEPT1.DEPTNO INNER JOIN EMP AS EMP3 ON EMP1.EMPNO = EMP3.EMPNO"
},
{
  "name": "testExtractJoinFilterRule",
  "q1": "SELECT 1 FROM EMP AS EMP INNER JOIN DEPT AS DEPT ON EMP.DEPTNO = DEPT.DEPTNO",
  "q2": "SELECT 1 FROM EMP AS EMP0, DEPT AS DEPT0 WHERE EMP0.DEPTNO = DEPT0.DEPTNO"
},
{
  "name": "testPushAggregateThroughJoinDistinct",
  "q1": "SELECT t.NAME, SUM(EMP.SAL) AS SUM_SAL, COUNT(*) AS C FROM EMP AS EMP INNER JOIN (SELECT DEPT.NAME FROM DEPT AS DEPT GROUP BY DEPT.NAME) AS t ON EMP.JOB = t.NAME GROUP BY t.NAME",
  "q2": "SELECT t2.NAME, t1.SUM_SAL, t1.C FROM (SELECT EMP0.JOB, SUM(EMP0.SAL) AS SUM_SAL, COUNT(*) AS C FROM EMP AS EMP0 GROUP BY EMP0.JOB) AS t1 INNER JOIN (SELECT DEPT0.NAME FROM DEPT AS DEPT0 GROUP BY DEPT0.NAME) AS t2 ON t1.JOB = t2.NAME"
},
{
  "name": "testTransitiveInferenceFullOuterJoin",
  "q1": "SELECT 1 FROM EMP AS EMP FULL JOIN EMP AS EMP0 ON EMP.DEPTNO = EMP0.DEPTNO WHERE EMP.DEPTNO > 7 AND EMP0.DEPTNO > 9",
  "q2": "SELECT 1 FROM EMP AS EMP1 FULL JOIN EMP AS EMP2 ON EMP1.DEPTNO = EMP2.DEPTNO WHERE EMP1.DEPTNO > 7 AND EMP2.DEPTNO > 9"
},
{
  "name": "testDecorrelateTwoIn",
  "q1": "SELECT EMP.SAL FROM EMP AS EMP WHERE EMP.EMPNO IN (SELECT DEPT.DEPTNO FROM DEPT AS DEPT WHERE EMP.JOB = DEPT.NAME) AND EMP.EMPNO IN (SELECT EMP0.EMPNO FROM EMP AS EMP0 WHERE EMP.ENAME = EMP0.ENAME)",
  "q2": "SELECT EMP1.SAL FROM EMP AS EMP1 INNER JOIN DEPT AS DEPT0 ON EMP1.JOB = DEPT0.NAME AND EMP1.EMPNO = DEPT0.DEPTNO INNER JOIN (SELECT EMP2.EMPNO, EMP2.ENAME FROM EMP AS EMP2) AS t5 ON EMP1.ENAME = t5.ENAME AND EMP1.EMPNO = t5.EMPNO"
},
{
  "name": "testPushProjectPastLeftJoinSwapStrong",
  "q1": "SELECT COUNT(*), CASE WHEN EMP.SAL < 11 THEN -1 * EMP.SAL ELSE EMP.SAL END FROM BONUS AS BONUS LEFT JOIN EMP AS EMP ON BONUS.ENAME = EMP.ENAME GROUP BY CASE WHEN EMP.SAL < 11 THEN -1 * EMP.SAL ELSE EMP.SAL END",
  "q2": "SELECT COUNT(*), t3.CASE FROM (SELECT BONUS0.ENAME FROM BONUS AS BONUS0) AS t2 LEFT JOIN (SELECT EMP0.ENAME, CASE WHEN EMP0.SAL < 11 THEN -1 * EMP0.SAL ELSE EMP0.SAL END AS CASE FROM EMP AS EMP0) AS t3 ON t2.ENAME = t3.ENAME GROUP BY t3.CASE"
},
{
  "name": "testExpandFilterExistsSimple",
  "q1": "SELECT EMP.EMPNO FROM EMP AS EMP WHERE EXISTS (SELECT * FROM EMP AS EMP0 WHERE EMP0.EMPNO < 20)",
  "q2": "SELECT EMP1.EMPNO FROM EMP AS EMP1, (SELECT TRUE AS i FROM EMP AS EMP2 WHERE EMP2.EMPNO < 20 GROUP BY TRUE) AS t4"
},
{
  "name": "basePullConstantTroughAggregate",
  "q1": "SELECT EMP.DEPTNO, MAX(EMP.MGR) FROM EMP AS EMP GROUP BY 42 + 24, EMP.DEPTNO",
  "q2": "SELECT EMP0.DEPTNO, MAX(EMP0.MGR) FROM EMP AS EMP0 GROUP BY EMP0.DEPTNO"
},
{
  "name": "basePushAggThroughUnion",
  "q1": "SELECT t.ENAME, SUM(t.EMPNO), COUNT(*), MIN(t.DEPTNO), MAX(t.EMPNO) FROM (SELECT * FROM EMP AS EMP UNION ALL SELECT * FROM EMP AS EMP0) AS t GROUP BY t.ENAME",
  "q2": "SELECT t6.ENAME, SUM(SUM(EMP2.EMPNO)), SUM(COUNT(*)), MIN(MIN(EMP2.DEPTNO)), MAX(MAX(EMP2.EMPNO)) FROM (SELECT EMP1.ENAME, SUM(EMP1.EMPNO), COUNT(*), MIN(EMP1.DEPTNO), MAX(EMP1.EMPNO) FROM EMP AS EMP1 GROUP BY EMP1.ENAME UNION ALL SELECT EMP2.ENAME, SUM(EMP2.EMPNO), COUNT(*), MIN(EMP2.DEPTNO), MAX(EMP2.EMPNO) FROM EMP AS EMP2 GROUP BY EMP2.ENAME) AS t6 GROUP BY t6.ENAME"
},
{
  "name": "testPushFilterWithRank",
  "q1": "SELECT * FROM (SELECT EMP.ENAME, RANK() OVER (PARTITION BY EMP.DEPTNO ORDER BY EMP.SAL RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS R FROM EMP AS EMP) AS t WHERE t.R < 2",
  "q2": "SELECT * FROM (SELECT EMP0.ENAME, RANK() OVER (PARTITION BY EMP0.DEPTNO ORDER BY EMP0.SAL RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS R FROM EMP AS EMP0) AS t1 WHERE t1.R < 2"
},
{
  "name": "basePushAggThroughUnion",
  "q1": "SELECT t.DEPTNO, t.JOB, SUM(t.MGR) FROM (SELECT * FROM EMP AS EMP UNION ALL SELECT * FROM EMP AS EMP0) AS t GROUP BY t.DEPTNO, t.JOB",
  "q2": "SELECT t6.DEPTNO, t6.JOB, SUM(SUM(EMP2.MGR)) FROM (SELECT EMP1.DEPTNO, EMP1.JOB, SUM(EMP1.MGR) FROM EMP AS EMP1 GROUP BY EMP1.DEPTNO, EMP1.JOB UNION ALL SELECT EMP2.DEPTNO, EMP2.JOB, SUM(EMP2.MGR) FROM EMP AS EMP2 GROUP BY EMP2.DEPTNO, EMP2.JOB) AS t6 GROUP BY t6.DEPTNO, t6.JOB"
},
{
  "name": "testMergeFilter",
  "q1": "SELECT t0.NAME FROM (SELECT * FROM DEPT AS DEPT WHERE DEPT.DEPTNO = 10) AS t WHERE t.DEPTNO = 10",
  "q2": "SELECT DEPT0.NAME FROM DEPT AS DEPT0 WHERE DEPT0.DEPTNO = 10"
},
{
  "name": "testDistinctCountGroupingSets1",
  "q1": "SELECT EMP.DEPTNO, EMP.JOB, COUNT(DISTINCT EMP.ENAME) FROM EMP AS EMP GROUP BY EMP.DEPTNO, EMP.JOB",
  "q2": "SELECT EMP0.DEPTNO, EMP0.JOB, COUNT(EMP0.ENAME) FROM EMP AS EMP0 GROUP BY EMP0.DEPTNO, EMP0.JOB"
},
{
  "name": "testDistinctCountGroupingSets2",
  "q1": "SELECT EMP.DEPTNO, EMP.JOB, COUNT(DISTINCT EMP.ENAME), SUM(EMP.SAL) FROM EMP AS EMP GROUP BY EMP.DEPTNO, EMP.JOB",
  "q2": "SELECT EMP0.DEPTNO, EMP0.JOB, COUNT(EMP0.ENAME), CAST(MIN(SUM(EMP0.SAL)) AS INTEGER) FROM EMP AS EMP0 GROUP BY EMP0.DEPTNO, EMP0.JOB"
},
{
  "name": "testPushProjectPastSetOp",
  "q1": "SELECT t.SAL FROM (SELECT * FROM EMP AS EMP UNION ALL SELECT * FROM EMP AS EMP0) AS t",
  "q2": "SELECT EMP1.SAL FROM EMP AS EMP1 UNION ALL SELECT EMP2.SAL FROM EMP AS EMP2"
},
{
  "name": "testMergeMinusRightDeep",
  "q1": "SELECT * FROM EMP AS EMP WHERE EMP.DEPTNO = 10 EXCEPT SELECT * FROM (SELECT * FROM EMP AS EMP0 WHERE EMP0.DEPTNO = 20 EXCEPT SELECT * FROM EMP AS EMP1 WHERE EMP1.DEPTNO = 30) AS t2",
  "q2": "SELECT * FROM EMP AS EMP2 WHERE EMP2.DEPTNO = 10 EXCEPT SELECT * FROM (SELECT * FROM EMP AS EMP3 WHERE EMP3.DEPTNO = 20 EXCEPT SELECT * FROM EMP AS EMP4 WHERE EMP4.DEPTNO = 30) AS t7"
},
{
  "name": "testPushFilterPastAgg",
  "q1": "SELECT DEPT.NAME AS DNAME, COUNT(*) AS C FROM DEPT AS DEPT GROUP BY DEPT.NAME HAVING DEPT.NAME = 'Charlie'",
  "q2": "SELECT t3.DNAME, COUNT(*) AS C FROM (SELECT DEPT0.NAME AS DNAME FROM DEPT AS DEPT0) AS t2 WHERE t2.DNAME = 'Charlie' GROUP BY t3.DNAME"
},
{
  "name": "testPushProjectPastFullJoin",
  "q1": "SELECT COUNT(*), CASE WHEN EMP.SAL < 11 THEN 11 ELSE -1 * EMP.SAL END FROM EMP AS EMP FULL JOIN BONUS AS BONUS ON EMP.ENAME = BONUS.ENAME GROUP BY CASE WHEN EMP.SAL < 11 THEN 11 ELSE -1 * EMP.SAL END",
  "q2": "SELECT COUNT(*), CASE WHEN t2.< THEN 11 ELSE t2.* END FROM (SELECT EMP0.ENAME, EMP0.SAL < 11 AS <, -1 * EMP0.SAL AS * FROM EMP AS EMP0) AS t2 FULL JOIN (SELECT BONUS0.ENAME FROM BONUS AS BONUS0) AS t3 ON t2.ENAME = t3.ENAME GROUP BY CASE WHEN t2.< THEN 11 ELSE t2.* END"
},
{
  "name": "testEmptyJoin",
  "q1": "SELECT * FROM (SELECT * FROM EMP AS EMP WHERE FALSE) AS t INNER JOIN DEPT AS DEPT ON t.DEPTNO = DEPT.DEPTNO",
  "q2": "SELECT * FROM (VALUES) AS t0"
},
{
  "name": "testEmptySort",
  "q1": "SELECT * FROM EMP AS EMP WHERE FALSE ORDER BY EMP.DEPTNO",
  "q2": "SELECT * FROM (VALUES) AS t1 ORDER BY t1.DEPTNO"
},
{
  "name": "testMultipleDistinctWithGrouping",
  "q1": "SELECT EMP.SAL, SUM(EMP.COMM), MIN(DISTINCT EMP.COMM), SUM(DISTINCT EMP.SAL) FROM EMP AS EMP GROUP BY EMP.SAL",
  "q2": "SELECT t2.SAL, SUM(EMP0.COMM), MIN(MIN(DISTINCT EMP.COMM)), SUM(t8.SAL) FROM (SELECT EMP0.SAL, SUM(EMP0.COMM) FROM EMP AS EMP0 GROUP BY EMP0.SAL) AS t2 INNER JOIN (SELECT t4.SAL, MIN(MIN(DISTINCT EMP.COMM)) FROM (SELECT EMP1.SAL, EMP1.COMM FROM EMP AS EMP1 GROUP BY EMP1.SAL, EMP1.COMM) AS t4 GROUP BY t4.SAL) AS t5 ON t2.SAL IS NOT DISTINCT FROM t5.SAL INNER JOIN (SELECT t8.SAL, SUM(t8.SAL) FROM (SELECT EMP2.SAL FROM EMP AS EMP2 GROUP BY EMP2.SAL) AS t8 GROUP BY t8.SAL) AS t9 ON t2.SAL IS NOT DISTINCT FROM t9.SAL"
},
{
  "name": "testReduceConstantsIsNull",
  "q1": "SELECT EMP.EMPNO FROM EMP AS EMP WHERE EMP.EMPNO = 10 AND EMP.EMPNO IS NULL",
  "q2": "SELECT t1.EMPNO FROM (VALUES) AS t1"
},
{
  "name": "testTransitiveInferenceJoin",
  "q1": "SELECT 1 FROM EMP AS EMP INNER JOIN (SELECT * FROM EMP AS EMP0 WHERE EMP0.DEPTNO > 7) AS t ON EMP.DEPTNO = t.DEPTNO",
  "q2": "SELECT 1 FROM (SELECT * FROM EMP AS EMP1 WHERE EMP1.DEPTNO > 7) AS t1 INNER JOIN (SELECT * FROM EMP AS EMP2 WHERE EMP2.DEPTNO > 7) AS t2 ON t1.DEPTNO = t2.DEPTNO"
},
{
  "name": "basePushAggThroughUnion",
  "q1": "SELECT t.DEPTNO, t.JOB, COUNT(t.MGR) FROM (SELECT * FROM EMP AS EMP UNION ALL SELECT * FROM EMP AS EMP0) AS t GROUP BY t.DEPTNO, t.JOB",
  "q2": "SELECT t6.DEPTNO, t6.JOB, SUM(COUNT(EMP2.MGR)) FROM (SELECT EMP1.DEPTNO, EMP1.JOB, COUNT(EMP1.MGR) FROM EMP AS EMP1 GROUP BY EMP1.DEPTNO, EMP1.JOB UNION ALL SELECT EMP2.DEPTNO, EMP2.JOB, COUNT(EMP2.MGR) FROM EMP AS EMP2 GROUP BY EMP2.DEPTNO, EMP2.JOB) AS t6 GROUP BY t6.DEPTNO, t6.JOB"
},
{
  "name": "testPushProjectPastRightJoinStrong",
  "q1": "SELECT COUNT(*), CASE WHEN EMP.SAL < 11 THEN -1 * EMP.SAL ELSE EMP.SAL END FROM EMP AS EMP RIGHT JOIN BONUS AS BONUS ON EMP.ENAME = BONUS.ENAME GROUP BY CASE WHEN EMP.SAL < 11 THEN -1 * EMP.SAL ELSE EMP.SAL END",
  "q2": "SELECT COUNT(*), t2.CASE FROM (SELECT EMP0.ENAME, CASE WHEN EMP0.SAL < 11 THEN -1 * EMP0.SAL ELSE EMP0.SAL END AS CASE FROM EMP AS EMP0) AS t2 RIGHT JOIN (SELECT BONUS0.ENAME FROM BONUS AS BONUS0) AS t3 ON t2.ENAME = t3.ENAME GROUP BY t2.CASE"
},
{
  "name": "testPushProjectPastRightJoinSwapStrong",
  "q1": "SELECT COUNT(*), CASE WHEN EMP.SAL < 11 THEN -1 * EMP.SAL ELSE EMP.SAL END FROM BONUS AS BONUS RIGHT JOIN EMP AS EMP ON BONUS.ENAME = EMP.ENAME GROUP BY CASE WHEN EMP.SAL < 11 THEN -1 * EMP.SAL ELSE EMP.SAL END",
  "q2": "SELECT COUNT(*), t3.CASE FROM (SELECT BONUS0.ENAME FROM BONUS AS BONUS0) AS t2 RIGHT JOIN (SELECT EMP0.ENAME, CASE WHEN EMP0.SAL < 11 THEN -1 * EMP0.SAL ELSE EMP0.SAL END AS CASE FROM EMP AS EMP0) AS t3 ON t2.ENAME = t3.ENAME GROUP BY t3.CASE"
},
{
  "name": "testSemiJoinRuleRight",
  "q1": "SELECT DEPT.DEPTNO, DEPT.NAME FROM DEPT AS DEPT RIGHT JOIN (SELECT EMP.DEPTNO FROM EMP AS EMP WHERE EMP.SAL > 100 GROUP BY EMP.DEPTNO) AS t1 ON DEPT.DEPTNO = t1.DEPTNO",
  "q2": "SELECT DEPT0.DEPTNO, DEPT0.NAME FROM DEPT AS DEPT0 RIGHT JOIN (SELECT EMP0.DEPTNO FROM EMP AS EMP0 WHERE EMP0.SAL > 100 GROUP BY EMP0.DEPTNO) AS t5 ON DEPT0.DEPTNO = t5.DEPTNO"
},
{
  "name": "testFullOuterJoinSimplificationToRightOuter",
  "q1": "SELECT 1 FROM DEPT AS DEPT FULL JOIN EMP AS EMP ON DEPT.DEPTNO = EMP.DEPTNO WHERE EMP.SAL > 100",
  "q2": "SELECT 1 FROM DEPT AS DEPT0 RIGHT JOIN (SELECT * FROM EMP AS EMP0 WHERE EMP0.SAL > 100) AS t1 ON DEPT0.DEPTNO = t1.DEPTNO"
},
{
  "name": "testPushFilterPastAggTwo",
  "q1": "SELECT DEPT.NAME AS C1 FROM DEPT AS DEPT WHERE DEPT.NAME > 'b' GROUP BY DEPT.NAME HAVING DEPT.NAME > 'c' AND (COUNT(*) > 30 OR DEPT.NAME < 'z')",
  "q2": "SELECT t6.C1 FROM (SELECT DEPT0.NAME AS C1 FROM DEPT AS DEPT0 WHERE DEPT0.NAME > 'b') AS t5 WHERE t5.C1 > 'c' GROUP BY t6.C1 HAVING COUNT(*) > 30 OR t6.C1 < 'z'"
},
{
  "name": "testPushAggregateSumNoGroup",
  "q1": "SELECT COUNT(*) FROM EMP AS EMP INNER JOIN DEPT AS DEPT ON EMP.JOB = DEPT.NAME",
  "q2": "SELECT SUM(COUNT(*) * COUNT(*)) FROM (SELECT EMP0.JOB, COUNT(*) FROM EMP AS EMP0 GROUP BY EMP0.JOB) AS t0 INNER JOIN (SELECT DEPT0.NAME, COUNT(*) FROM DEPT AS DEPT0 GROUP BY DEPT0.NAME) AS t1 ON t0.JOB = t1.NAME"
},
{
  "name": "testPushProjectPastLeftJoin",
  "q1": "SELECT COUNT(*), CASE WHEN EMP.SAL < 11 THEN 11 ELSE -1 * EMP.SAL END FROM EMP AS EMP LEFT JOIN BONUS AS BONUS ON EMP.ENAME = BONUS.ENAME GROUP BY CASE WHEN EMP.SAL < 11 THEN 11 ELSE -1 * EMP.SAL END",
  "q2": "SELECT COUNT(*), t2.CASE FROM (SELECT EMP0.ENAME, CASE WHEN EMP0.SAL < 11 THEN 11 ELSE -1 * EMP0.SAL END AS CASE FROM EMP AS EMP0) AS t2 LEFT JOIN (SELECT BONUS0.ENAME FROM BONUS AS BONUS0) AS t3 ON t2.ENAME = t3.ENAME GROUP BY t2.CASE"
},
{
  "name": "testSortUnionTranspose",
  "q1": "SELECT * FROM (SELECT DEPT.NAME FROM DEPT AS DEPT UNION ALL SELECT DEPT0.NAME FROM DEPT AS DEPT0) AS t1 ORDER BY t1.NAME FETCH NEXT 10 ROWS ONLY",
  "q2": "SELECT * FROM (SELECT DEPT1.NAME FROM DEPT AS DEPT1 ORDER BY DEPT1.NAME FETCH NEXT 10 ROWS ONLY UNION ALL SELECT DEPT2.NAME FROM DEPT AS DEPT2 ORDER BY DEPT2.NAME FETCH NEXT 10 ROWS ONLY) AS t10 ORDER BY t10.NAME FETCH NEXT 10 ROWS ONLY"
},
{
  "name": "testReduceConstantsNegated",
  "q1": "SELECT EMP.EMPNO FROM EMP AS EMP WHERE EMP.EMPNO = 10 AND NOT EMP.EMPNO = 10",
  "q2": "SELECT t1.EMPNO FROM (VALUES) AS t1"
},
{
  "name": "testPushSemiJoinPastProject",
  "q1": "SELECT t.ENAME, TRIM(BOTH ' ' FROM EMP.JOB), EMP.SAL * 2, t.DEPTNO FROM (SELECT EMP.ENAME, TRIM(BOTH ' ' FROM EMP.JOB), EMP.SAL * 2, EMP.DEPTNO FROM EMP AS EMP) AS t, DEPT AS DEPT WHERE t.DEPTNO = DEPT.DEPTNO",
  "q2": "SELECT t2.ENAME, TRIM(BOTH ' ' FROM EMP0.JOB), EMP0.SAL * 2, t2.DEPTNO FROM (SELECT EMP0.ENAME, TRIM(BOTH ' ' FROM EMP0.JOB), EMP0.SAL * 2, EMP0.DEPTNO FROM EMP AS EMP0 INNER JOIN DEPT AS DEPT0 ON EMP0.DEPTNO = DEPT0.DEPTNO) AS t2 INNER JOIN DEPT AS DEPT1 ON t2.DEPTNO = DEPT1.DEPTNO"
},
{
  "name": "testPushFilterWithRankExpr",
  "q1": "SELECT * FROM (SELECT EMP.ENAME, (RANK() OVER (PARTITION BY EMP.DEPTNO ORDER BY EMP.SAL RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)) + 1 AS R FROM EMP AS EMP) AS t WHERE t.R < 2",
  "q2": "SELECT * FROM (SELECT EMP0.ENAME, (RANK() OVER (PARTITION BY EMP0.DEPTNO ORDER BY EMP0.SAL RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)) + 1 AS R FROM EMP AS EMP0) AS t1 WHERE t1.R < 2"
},
{
  "name": "testReduceNullableCase",
  "q1": "SELECT CASE WHEN 1 = 2 THEN CAST(t0.EXPR$0 AS INTEGER) ELSE 2 END FROM (VALUES  (1)) AS t LEFT JOIN (VALUES  (1)) AS t0 ON TRUE",
  "q2": "SELECT CAST(2 AS INTEGER) FROM (VALUES  (1)) AS t2 LEFT JOIN (VALUES  (1)) AS t3 ON TRUE"
},
{
  "name": "testEmptyAggregateEmptyKey",
  "q1": "SELECT SUM(t.EMPNO) FROM (VALUES) AS t",
  "q2": "SELECT SUM(t1.EMPNO) FROM (VALUES) AS t1"
},
{
  "name": "testSortJoinTranspose1",
  "q1": "SELECT * FROM EMP AS EMP LEFT JOIN DEPT AS DEPT ON EMP.DEPTNO = DEPT.DEPTNO ORDER BY EMP.SAL FETCH NEXT 10 ROWS ONLY",
  "q2": "SELECT * FROM (SELECT * FROM EMP AS EMP0 ORDER BY EMP0.SAL FETCH NEXT 10 ROWS ONLY) AS t2 LEFT JOIN DEPT AS DEPT0 ON t2.DEPTNO = DEPT0.DEPTNO ORDER BY t2.SAL FETCH NEXT 10 ROWS ONLY"
},
{
  "name": "testSortJoinTranspose2",
  "q1": "SELECT * FROM EMP AS EMP RIGHT JOIN DEPT AS DEPT ON EMP.DEPTNO = DEPT.DEPTNO ORDER BY DEPT.NAME",
  "q2": "SELECT * FROM EMP AS EMP0 RIGHT JOIN (SELECT * FROM DEPT AS DEPT0 ORDER BY DEPT0.NAME) AS t0 ON EMP0.DEPTNO = t0.DEPTNO ORDER BY t0.NAME"
},
{
  "name": "testSortJoinTranspose3",
  "q1": "SELECT * FROM EMP AS EMP LEFT JOIN DEPT AS DEPT ON EMP.DEPTNO = DEPT.DEPTNO ORDER BY EMP.SAL, DEPT.NAME FETCH NEXT 10 ROWS ONLY",
  "q2": "SELECT * FROM EMP AS EMP0 LEFT JOIN DEPT AS DEPT0 ON EMP0.DEPTNO = DEPT0.DEPTNO ORDER BY EMP0.SAL, DEPT0.NAME FETCH NEXT 10 ROWS ONLY"
},
{
  "name": "testSortJoinTranspose4",
  "q1": "SELECT * FROM EMP AS EMP RIGHT JOIN DEPT AS DEPT ON EMP.DEPTNO = DEPT.DEPTNO ORDER BY DEPT.NAME",
  "q2": "SELECT * FROM EMP AS EMP0 RIGHT JOIN (SELECT * FROM DEPT AS DEPT0 ORDER BY DEPT0.NAME) AS t0 ON EMP0.DEPTNO = t0.DEPTNO ORDER BY t0.NAME"
},
{
  "name": "testSortJoinTranspose5",
  "q1": "SELECT * FROM EMP AS EMP RIGHT JOIN (SELECT * FROM DEPT AS DEPT FETCH NEXT 10 ROWS ONLY) AS t ON EMP.DEPTNO = t.DEPTNO FETCH NEXT 10 ROWS ONLY",
  "q2": "SELECT * FROM EMP AS EMP0 RIGHT JOIN (SELECT * FROM DEPT AS DEPT0 FETCH NEXT 10 ROWS ONLY) AS t1 ON EMP0.DEPTNO = t1.DEPTNO FETCH NEXT 10 ROWS ONLY"
},
{
  "name": "testUnionMergeRule",
  "q1": "SELECT * FROM (SELECT DEPT.NAME, DEPT.DEPTNO FROM DEPT AS DEPT UNION ALL SELECT t4.NAME, t4.DEPTNO FROM (SELECT DEPT0.NAME, DEPT0.DEPTNO, COUNT(*) FROM DEPT AS DEPT0 GROUP BY DEPT0.NAME, DEPT0.DEPTNO UNION ALL SELECT DEPT1.NAME, DEPT1.DEPTNO, COUNT(*) FROM DEPT AS DEPT1 GROUP BY DEPT1.NAME, DEPT1.DEPTNO) AS t4) AS t6 UNION ALL SELECT DEPT2.NAME, DEPT2.DEPTNO FROM DEPT AS DEPT2",
  "q2": "SELECT DEPT3.NAME, DEPT3.DEPTNO FROM DEPT AS DEPT3 UNION ALL SELECT DEPT4.NAME, DEPT4.DEPTNO FROM DEPT AS DEPT4 GROUP BY DEPT4.NAME, DEPT4.DEPTNO UNION ALL SELECT DEPT5.NAME, DEPT5.DEPTNO FROM DEPT AS DEPT5 GROUP BY DEPT5.NAME, DEPT5.DEPTNO UNION ALL SELECT DEPT6.NAME, DEPT6.DEPTNO FROM DEPT AS DEPT6"
},
{
  "name": "testSemiJoinRule",
  "q1": "SELECT DEPT.DEPTNO, DEPT.NAME FROM DEPT AS DEPT INNER JOIN (SELECT EMP.DEPTNO FROM EMP AS EMP WHERE EMP.SAL > 100 GROUP BY EMP.DEPTNO) AS t1 ON DEPT.DEPTNO = t1.DEPTNO",
  "q2": "SELECT * FROM DEPT AS DEPT0 INNER JOIN (SELECT EMP0.DEPTNO FROM EMP AS EMP0 WHERE EMP0.SAL > 100) AS t4 ON DEPT0.DEPTNO = t4.DEPTNO"
},
{
  "name": "testSemiJoinTrim",
  "q1": "SELECT S.DEPTNO FROM (SELECT DEPT.DEPTNO, DEPT.NAME FROM DEPT AS DEPT WHERE EXISTS (SELECT EMP.EMPNO, EMP.ENAME, EMP.JOB, EMP.MGR, EMP.HIREDATE, EMP.SAL, EMP.COMM, EMP.DEPTNO, EMP.SLACKER FROM EMP AS EMP WHERE EMP.DEPTNO = DEPT.DEPTNO AND EMP.SAL > 100)) AS S INNER JOIN ACCOUNT AS ACCOUNT ON S.DEPTNO = ACCOUNT.ACCTNO",
  "q2": "SELECT t.DEPTNO FROM (SELECT DEPT.DEPTNO FROM DEPT AS DEPT) AS t INNER JOIN (SELECT t1.DEPTNO AS DEPTNO9 FROM (SELECT EMP.SAL, EMP.DEPTNO FROM EMP AS EMP) AS t0 WHERE t0.SAL > 100) AS t2 ON t.DEPTNO = t2.DEPTNO9 INNER JOIN (SELECT ACCOUNT.ACCTNO FROM ACCOUNT AS ACCOUNT) AS t3 ON t.DEPTNO = t3.ACCTNO"
},
{
  "name": "testTransitiveInferenceConstantEquiPredicate",
  "q1": "SELECT 1 FROM EMP AS EMP INNER JOIN EMP AS EMP0 ON EMP.DEPTNO = EMP0.DEPTNO",
  "q2": "SELECT 1 FROM EMP AS EMP1 INNER JOIN EMP AS EMP2 ON EMP1.DEPTNO = EMP2.DEPTNO"
},
{
  "name": "testReduceValuesToEmpty",
  "q1": "SELECT t0.EXPR$0 + t0.EXPR$1 AS X, t0.EXPR$1 AS B, t0.EXPR$0 AS A FROM (VALUES  (10, 1),  (30, 7)) AS t WHERE t.EXPR$0 - t.EXPR$1 < 0",
  "q2": "SELECT * FROM (VALUES) AS t2"
},
{
  "name": "testPushProjectPastFilter",
  "q1": "SELECT EMP.EMPNO + EMP.DEPTNO FROM EMP AS EMP WHERE EMP.SAL = 10 * EMP.COMM AND UPPER(EMP.ENAME) = 'FOO'",
  "q2": "SELECT t2.EMPNO + t2.DEPTNO FROM (SELECT EMP0.EMPNO, EMP0.ENAME, EMP0.SAL, EMP0.COMM, EMP0.DEPTNO FROM EMP AS EMP0) AS t1 WHERE t1.SAL = 10 * t1.COMM AND UPPER(t1.ENAME) = 'FOO'"
},
{
  "name": "testDistinctNonDistinctTwoAggregatesWithGrouping",
  "q1": "SELECT EMP.DEPTNO, SUM(EMP.COMM), MIN(EMP.COMM), SUM(DISTINCT EMP.SAL) FROM EMP AS EMP GROUP BY EMP.DEPTNO",
  "q2": "SELECT t2.DEPTNO, SUM(MIN(EMP0.COMM)), MIN(SUM(DISTINCT EMP.SAL)), SUM(SUM(MIN(EMP0.COMM))) FROM (SELECT EMP0.DEPTNO, EMP0.SAL, SUM(EMP0.COMM), MIN(EMP0.COMM) FROM EMP AS EMP0 GROUP BY EMP0.DEPTNO, EMP0.SAL) AS t2 GROUP BY t2.DEPTNO"
},
{
  "name": "testAggregateGroupingSetsProjectMerge",
  "q1": "SELECT EMP.DEPTNO AS X, SUM(EMP.SAL), EMP.EMPNO AS Y FROM EMP AS EMP GROUP BY EMP.DEPTNO, EMP.EMPNO",
  "q2": "SELECT EMP0.DEPTNO AS X, SUM(EMP0.SAL), EMP0.EMPNO AS Y FROM EMP AS EMP0 GROUP BY EMP0.EMPNO, EMP0.DEPTNO"
},
{
  "name": "testPushFilterThroughSemiJoin",
  "q1": "SELECT * FROM DEPT AS DEPT INNER JOIN (SELECT EMP.DEPTNO FROM EMP AS EMP) AS t ON DEPT.DEPTNO = t.DEPTNO WHERE DEPT.DEPTNO <= 10",
  "q2": "SELECT * FROM (SELECT * FROM DEPT AS DEPT0 WHERE DEPT0.DEPTNO <= 10) AS t1 INNER JOIN (SELECT EMP0.DEPTNO FROM EMP AS EMP0) AS t2 ON t1.DEPTNO = t2.DEPTNO"
},
{
  "name": "basePushAggThroughUnion",
  "q1": "SELECT t.ENAME, MIN(t.EMPNO) FROM (SELECT * FROM EMP AS EMP UNION ALL SELECT * FROM EMP AS EMP0) AS t GROUP BY t.ENAME",
  "q2": "SELECT t6.ENAME, MIN(MIN(EMP2.EMPNO)) FROM (SELECT EMP1.ENAME, MIN(EMP1.EMPNO) FROM EMP AS EMP1 GROUP BY EMP1.ENAME UNION ALL SELECT EMP2.ENAME, MIN(EMP2.EMPNO) FROM EMP AS EMP2 GROUP BY EMP2.ENAME) AS t6 GROUP BY t6.ENAME"
},
{
  "name": "basePushAggThroughUnion",
  "q1": "SELECT t1.DEPTNO, t1.JOB, SUM(t1.U) FROM (SELECT EMP.EMPNO, EMP.ENAME, EMP.JOB, EMP.MGR, EMP.HIREDATE, EMP.SAL, EMP.COMM, EMP.DEPTNO, EMP.SLACKER, 2 AS U FROM EMP AS EMP UNION ALL SELECT EMP0.EMPNO, EMP0.ENAME, EMP0.JOB, EMP0.MGR, EMP0.HIREDATE, EMP0.SAL, EMP0.COMM, EMP0.DEPTNO, EMP0.SLACKER, 3 AS U FROM EMP AS EMP0) AS t1 GROUP BY t1.DEPTNO, t1.JOB",
  "q2": "SELECT t8.DEPTNO, t8.JOB, SUM(SUM(3)) FROM (SELECT EMP1.DEPTNO, EMP1.JOB, SUM(2) FROM EMP AS EMP1 GROUP BY EMP1.DEPTNO, EMP1.JOB UNION ALL SELECT EMP2.DEPTNO, EMP2.JOB, SUM(3) FROM EMP AS EMP2 GROUP BY EMP2.DEPTNO, EMP2.JOB) AS t8 GROUP BY t8.DEPTNO, t8.JOB"
},
{
  "name": "basePushFilterPastAggWithGroupingSets",
  "q1": "SELECT DEPT.DEPTNO, DEPT.NAME, COUNT(*) AS C FROM DEPT AS DEPT GROUP BY DEPT.DEPTNO, DEPT.NAME HAVING DEPT.NAME = 'Charlie'",
  "q2": "SELECT DEPT0.DEPTNO, DEPT0.NAME, COUNT(*) AS C FROM DEPT AS DEPT0 GROUP BY DEPT0.DEPTNO, DEPT0.NAME HAVING DEPT0.NAME = 'Charlie'"
},
{
  "name": "basePushFilterPastAggWithGroupingSets",
  "q1": "SELECT DEPT.NAME AS DNAME, DEPT.DEPTNO AS DDEPTNO, COUNT(*) AS C FROM DEPT AS DEPT GROUP BY DEPT.NAME, DEPT.DEPTNO HAVING DEPT.NAME = 'Charlie'",
  "q2": "SELECT t3.DNAME, t3.DDEPTNO, COUNT(*) AS C FROM (SELECT DEPT0.NAME AS DNAME, DEPT0.DEPTNO AS DDEPTNO FROM DEPT AS DEPT0) AS t2 WHERE t2.DNAME = 'Charlie' GROUP BY t3.DNAME, t3.DDEPTNO"
},
{
  "name": "testTransitiveInferenceUnion3way",
  "q1": "SELECT 1 FROM (SELECT * FROM (SELECT EMP.DEPTNO FROM EMP AS EMP WHERE EMP.DEPTNO > 7 UNION ALL SELECT EMP0.DEPTNO FROM EMP AS EMP0 WHERE EMP0.DEPTNO > 10) AS t3 UNION ALL SELECT EMP1.DEPTNO FROM EMP AS EMP1 WHERE EMP1.DEPTNO > 1) AS t6 INNER JOIN EMP AS EMP2 ON t6.DEPTNO = EMP2.DEPTNO",
  "q2": "SELECT 1 FROM (SELECT * FROM (SELECT EMP3.DEPTNO FROM EMP AS EMP3 WHERE EMP3.DEPTNO > 7 UNION ALL SELECT EMP4.DEPTNO FROM EMP AS EMP4 WHERE EMP4.DEPTNO > 10) AS t12 UNION ALL SELECT EMP5.DEPTNO FROM EMP AS EMP5 WHERE EMP5.DEPTNO > 1) AS t15 INNER JOIN (SELECT * FROM EMP AS EMP6 WHERE EMP6.DEPTNO > 7 OR EMP6.DEPTNO > 10 OR EMP6.DEPTNO > 1) AS t16 ON t15.DEPTNO = t16.DEPTNO"
},
{
  "name": "testCastInAggregateReduceFunctions",
  "q1": "SELECT DEPT.NAME, STDDEV_POP(DEPT.DEPTNO), AVG(DEPT.DEPTNO), STDDEV_SAMP(DEPT.DEPTNO), VAR_POP(DEPT.DEPTNO), VAR_SAMP(DEPT.DEPTNO) FROM DEPT AS DEPT GROUP BY DEPT.NAME",
  "q2": "SELECT DEPT0.NAME, CAST(POWER((SUM(DEPT0.DEPTNO * DEPT0.DEPTNO) - SUM(DEPT0.DEPTNO) * SUM(DEPT0.DEPTNO) / COUNT(*)) / COUNT(*), 0.5) AS INTEGER), CAST(SUM(DEPT0.DEPTNO) / COUNT(*) AS INTEGER), CAST(POWER((SUM(DEPT0.DEPTNO * DEPT0.DEPTNO) - SUM(DEPT0.DEPTNO) * SUM(DEPT0.DEPTNO) / COUNT(*)) / CASE WHEN COUNT(*) = 1 THEN NULL ELSE COUNT(*) - 1 END, 0.5) AS INTEGER), CAST((SUM(DEPT0.DEPTNO * DEPT0.DEPTNO) - SUM(DEPT0.DEPTNO) * SUM(DEPT0.DEPTNO) / COUNT(*)) / COUNT(*) AS INTEGER), CAST((SUM(DEPT0.DEPTNO * DEPT0.DEPTNO) - SUM(DEPT0.DEPTNO) * SUM(DEPT0.DEPTNO) / COUNT(*)) / CASE WHEN COUNT(*) = 1 THEN NULL ELSE COUNT(*) - 1 END AS INTEGER) FROM DEPT AS DEPT0 GROUP BY DEPT0.NAME"
},
{
  "name": "basePullConstantTroughAggregate",
  "q1": "SELECT EMP.DEPTNO, MAX(EMP.MGR) FROM EMP AS EMP GROUP BY EMP.DEPTNO, 4",
  "q2": "SELECT EMP0.DEPTNO, MAX(EMP0.MGR) FROM EMP AS EMP0 GROUP BY EMP0.DEPTNO"
},
{
  "name": "testIntersectToDistinctAll",
  "q1": "SELECT * FROM (SELECT * FROM EMP AS EMP WHERE EMP.DEPTNO = 10 INTERSECT SELECT * FROM EMP AS EMP0 WHERE EMP0.DEPTNO = 20) AS t1 INTERSECT ALL SELECT * FROM EMP AS EMP1 WHERE EMP1.DEPTNO = 30",
  "q2": "SELECT t8.EMPNO, t8.ENAME, t8.JOB, t8.MGR, t8.HIREDATE, t8.SAL, t8.COMM, t8.DEPTNO, t8.SLACKER FROM (SELECT EMP2.EMPNO, EMP2.ENAME, EMP2.JOB, EMP2.MGR, EMP2.HIREDATE, EMP2.SAL, EMP2.COMM, EMP2.DEPTNO, EMP2.SLACKER, COUNT(*) AS $f9 FROM EMP AS EMP2 WHERE EMP2.DEPTNO = 10 GROUP BY EMP2.EMPNO, EMP2.ENAME, EMP2.JOB, EMP2.MGR, EMP2.HIREDATE, EMP2.SAL, EMP2.COMM, EMP2.DEPTNO, EMP2.SLACKER UNION ALL SELECT EMP3.EMPNO, EMP3.ENAME, EMP3.JOB, EMP3.MGR, EMP3.HIREDATE, EMP3.SAL, EMP3.COMM, EMP3.DEPTNO, EMP3.SLACKER, COUNT(*) AS $f9 FROM EMP AS EMP3 WHERE EMP3.DEPTNO = 20 GROUP BY EMP3.EMPNO, EMP3.ENAME, EMP3.JOB, EMP3.MGR, EMP3.HIREDATE, EMP3.SAL, EMP3.COMM, EMP3.DEPTNO, EMP3.SLACKER) AS t8 GROUP BY t8.EMPNO, t8.ENAME, t8.JOB, t8.MGR, t8.HIREDATE, t8.SAL, t8.COMM, t8.DEPTNO, t8.SLACKER HAVING COUNT(*) = 2 INTERSECT ALL SELECT * FROM EMP AS EMP4 WHERE EMP4.DEPTNO = 30"
},
{
  "name": "testEmptyJoinRight",
  "q1": "SELECT * FROM (SELECT * FROM EMP AS EMP WHERE FALSE) AS t RIGHT JOIN DEPT AS DEPT ON t.DEPTNO = DEPT.DEPTNO",
  "q2": "SELECT * FROM (VALUES) AS t0 RIGHT JOIN DEPT AS DEPT0 ON t0.DEPTNO = DEPT0.DEPTNO"
},
{
  "name": "testTransitiveInferenceLeftOuterJoin",
  "q1": "SELECT 1 FROM (SELECT * FROM EMP AS EMP WHERE EMP.DEPTNO > 7) AS t LEFT JOIN EMP AS EMP0 ON t.DEPTNO = EMP0.DEPTNO WHERE EMP0.DEPTNO > 9",
  "q2": "SELECT 1 FROM (SELECT * FROM EMP AS EMP1 WHERE EMP1.DEPTNO > 7) AS t2 LEFT JOIN (SELECT * FROM EMP AS EMP2 WHERE EMP2.DEPTNO > 7) AS t3 ON t2.DEPTNO = t3.DEPTNO WHERE t3.DEPTNO > 9"
},
{
  "name": "basePushAggThroughUnion",
  "q1": "SELECT t.DEPTNO, t.JOB, MAX(t.MGR) FROM (SELECT * FROM EMP AS EMP UNION ALL SELECT * FROM EMP AS EMP0) AS t GROUP BY t.DEPTNO, t.JOB",
  "q2": "SELECT t6.DEPTNO, t6.JOB, MAX(MAX(EMP2.MGR)) FROM (SELECT EMP1.DEPTNO, EMP1.JOB, MAX(EMP1.MGR) FROM EMP AS EMP1 GROUP BY EMP1.DEPTNO, EMP1.JOB UNION ALL SELECT EMP2.DEPTNO, EMP2.JOB, MAX(EMP2.MGR) FROM EMP AS EMP2 GROUP BY EMP2.DEPTNO, EMP2.JOB) AS t6 GROUP BY t6.DEPTNO, t6.JOB"
},
{
  "name": "testReduceConstants2",
  "q1": "SELECT CAST(CASE WHEN NULL IS NULL THEN 2 IS NULL WHEN 2 IS NULL THEN NULL IS NULL ELSE NULL = 2 END AS BOOLEAN) FROM (VALUES  (0)) AS t",
  "q2": "SELECT FALSE FROM (VALUES  (0)) AS t2"
},
{
  "name": "testPushJoinThroughUnionOnRight",
  "q1": "SELECT EMP.SAL FROM EMP AS EMP, (SELECT * FROM EMP AS EMP0 UNION ALL SELECT * FROM EMP AS EMP1) AS t",
  "q2": "SELECT t1.SAL FROM (SELECT * FROM EMP AS EMP2, EMP AS EMP3 UNION ALL SELECT * FROM EMP AS EMP4, EMP AS EMP5) AS t1"
},
{
  "name": "testFullOuterJoinSimplificationToInner",
  "q1": "SELECT 1 FROM DEPT AS DEPT FULL JOIN EMP AS EMP ON DEPT.DEPTNO = EMP.DEPTNO WHERE DEPT.NAME = 'Charlie' AND EMP.SAL > 100",
  "q2": "SELECT 1 FROM (SELECT * FROM DEPT AS DEPT0 WHERE DEPT0.NAME = 'Charlie') AS t1 INNER JOIN (SELECT * FROM EMP AS EMP0 WHERE EMP0.SAL > 100) AS t2 ON t1.DEPTNO = t2.DEPTNO"
},
{
  "name": "basePushAggThroughUnion",
  "q1": "SELECT t.DEPTNO, t.JOB, AVG(t.EMPNO) FROM (SELECT * FROM EMP AS EMP UNION ALL SELECT * FROM EMP AS EMP0) AS t GROUP BY t.DEPTNO, t.JOB",
  "q2": "SELECT t4.DEPTNO, t4.JOB, AVG(t4.EMPNO) FROM (SELECT EMP1.DEPTNO, EMP1.JOB, EMP1.EMPNO FROM EMP AS EMP1 UNION ALL SELECT EMP2.DEPTNO, EMP2.JOB, EMP2.EMPNO FROM EMP AS EMP2) AS t4 GROUP BY t4.DEPTNO, t4.JOB"
},
{
  "name": "testReduceOrCaseWhen",
  "q1": "SELECT EMP.SAL FROM EMP AS EMP WHERE CASE WHEN EMP.SAL = 1000 THEN NULL ELSE 1 END IS NULL OR CASE WHEN EMP.SAL = 2000 THEN NULL ELSE 1 END IS NULL",
  "q2": "SELECT EMP0.SAL FROM EMP AS EMP0 WHERE EMP0.SAL = 1000 OR EMP0.SAL = 2000"
},
{
  "name": "testReduceAverage",
  "q1": "SELECT DEPT.NAME, MAX(DEPT.NAME), AVG(DEPT.DEPTNO), MIN(DEPT.NAME) FROM DEPT AS DEPT GROUP BY DEPT.NAME",
  "q2": "SELECT DEPT0.NAME, MAX(DEPT0.NAME), CAST(SUM(DEPT0.DEPTNO) / COUNT(*) AS INTEGER), MIN(DEPT0.NAME) FROM DEPT AS DEPT0 GROUP BY DEPT0.NAME"
},
{
  "name": "testMergeUnionAll",
  "q1": "SELECT * FROM (SELECT * FROM EMP AS EMP WHERE EMP.DEPTNO = 10 UNION ALL SELECT * FROM EMP AS EMP0 WHERE EMP0.DEPTNO = 20) AS t1 UNION ALL SELECT * FROM EMP AS EMP1 WHERE EMP1.DEPTNO = 30",
  "q2": "SELECT * FROM EMP AS EMP2 WHERE EMP2.DEPTNO = 10 UNION ALL SELECT * FROM EMP AS EMP3 WHERE EMP3.DEPTNO = 20 UNION ALL SELECT * FROM EMP AS EMP4 WHERE EMP4.DEPTNO = 30"
},
{
  "name": "testReduceCasts",
  "q1": "SELECT CAST(t2.NAME AS VARCHAR(128)), CAST(t2.EMPNO AS INTEGER) FROM (SELECT t.DEPTNO, t.NAME, t0.EMPNO, t0.ENAME, t0.JOB, t0.MGR, t0.HIREDATE, t0.SAL, t0.COMM, t0.DEPTNO AS DEPTNO1, t0.SLACKER FROM (SELECT DEPT.DEPTNO, DEPT.NAME, CAST(DEPT.DEPTNO AS INTEGER) AS DEPTNO0 FROM DEPT AS DEPT) AS t INNER JOIN (SELECT EMP.EMPNO, EMP.ENAME, EMP.JOB, EMP.MGR, EMP.HIREDATE, EMP.SAL, EMP.COMM, EMP.DEPTNO, EMP.SLACKER, CAST(EMP.DEPTNO AS INTEGER) AS DEPTNO0 FROM EMP AS EMP) AS t0 ON t.DEPTNO0 = t0.DEPTNO0) AS t1 WHERE CAST(t1.JOB AS VARCHAR(1)) = 'Manager'",
  "q2": "SELECT CAST(t7.NAME AS VARCHAR(128)), t7.EMPNO FROM (SELECT t4.DEPTNO, t4.NAME, t5.EMPNO, t5.ENAME, t5.JOB, t5.MGR, t5.HIREDATE, t5.SAL, t5.COMM, t5.DEPTNO AS DEPTNO1, t5.SLACKER FROM (SELECT DEPT0.DEPTNO, DEPT0.NAME, DEPT0.DEPTNO AS DEPTNO0 FROM DEPT AS DEPT0) AS t4 INNER JOIN (SELECT EMP0.EMPNO, EMP0.ENAME, EMP0.JOB, EMP0.MGR, EMP0.HIREDATE, EMP0.SAL, EMP0.COMM, EMP0.DEPTNO, EMP0.SLACKER, EMP0.DEPTNO AS DEPTNO0 FROM EMP AS EMP0) AS t5 ON t4.DEPTNO0 = t5.DEPTNO0) AS t6 WHERE CAST(t6.JOB AS VARCHAR(1)) = 'Manager'"
},
{
  "name": "testLeftOuterJoinSimplificationToInner",
  "q1": "SELECT 1 FROM DEPT AS DEPT LEFT JOIN EMP AS EMP ON DEPT.DEPTNO = EMP.DEPTNO WHERE EMP.SAL > 100",
  "q2": "SELECT 1 FROM DEPT AS DEPT0 INNER JOIN (SELECT * FROM EMP AS EMP0 WHERE EMP0.SAL > 100) AS t1 ON DEPT0.DEPTNO = t1.DEPTNO"
},
{
  "name": "basePushAggThroughUnion",
  "q1": "SELECT SUM(t.MGR) FROM (SELECT * FROM EMP AS EMP UNION ALL SELECT * FROM EMP AS EMP0) AS t",
  "q2": "SELECT SUM(SUM(EMP2.MGR)) FROM (SELECT SUM(EMP1.MGR) FROM EMP AS EMP1 UNION ALL SELECT SUM(EMP2.MGR) FROM EMP AS EMP2) AS t6"
},
{
  "name": "testEmptyMinus2",
  "q1": "SELECT * FROM (SELECT * FROM (SELECT * FROM (VALUES  (30, 3)) AS t EXCEPT SELECT * FROM (VALUES  (20, 2)) AS t0 WHERE t0.EXPR$0 > 30) AS t2 EXCEPT SELECT * FROM (VALUES  (40, 4)) AS t3) AS t4 EXCEPT SELECT * FROM (VALUES  (50, 5)) AS t5 WHERE t5.EXPR$0 > 50",
  "q2": "SELECT * FROM (VALUES  (30, 3)) AS t8 EXCEPT SELECT * FROM (VALUES  (40, 4)) AS t9"
},
{
  "name": "testPushAggregateThroughJoin1",
  "q1": "SELECT t.JOB, DEPT.NAME FROM (SELECT * FROM EMP AS EMP WHERE EMP.EMPNO = 10) AS t INNER JOIN DEPT AS DEPT ON t.JOB = DEPT.NAME GROUP BY t.JOB, DEPT.NAME",
  "q2": "SELECT * FROM (SELECT EMP0.JOB FROM EMP AS EMP0 WHERE EMP0.EMPNO = 10 GROUP BY EMP0.JOB) AS t2 INNER JOIN (SELECT DEPT0.NAME FROM DEPT AS DEPT0 GROUP BY DEPT0.NAME) AS t3 ON t2.JOB = t3.NAME"
},
{
  "name": "testPushAggregateThroughJoin2",
  "q1": "SELECT t0.JOB, t1.NAME FROM (SELECT EMP.EMPNO, EMP.ENAME, EMP.JOB, EMP.MGR, EMP.HIREDATE, EMP.SAL, EMP.COMM, EMP.DEPTNO, EMP.SLACKER, EMP.DEPTNO + EMP.EMPNO AS $f9 FROM EMP AS EMP WHERE EMP.EMPNO = 10) AS t0 INNER JOIN (SELECT DEPT.DEPTNO, DEPT.NAME, DEPT.DEPTNO + 5 AS $f2 FROM DEPT AS DEPT) AS t1 ON t0.JOB = t1.NAME AND t0.$f9 = t1.$f2 GROUP BY t0.JOB, t1.NAME",
  "q2": "SELECT t5.JOB, t7.NAME FROM (SELECT EMP0.JOB, EMP0.DEPTNO + EMP0.EMPNO AS $f9 FROM EMP AS EMP0 WHERE EMP0.EMPNO = 10 GROUP BY EMP0.JOB, EMP0.DEPTNO + EMP0.EMPNO) AS t5 INNER JOIN (SELECT DEPT0.NAME, DEPT0.DEPTNO + 5 AS $f2 FROM DEPT AS DEPT0 GROUP BY DEPT0.NAME, DEPT0.DEPTNO + 5) AS t7 ON t5.JOB = t7.NAME AND t5.$f9 = t7.$f2 GROUP BY t5.JOB, t7.NAME"
},
{
  "name": "testPushAggregateThroughJoin3",
  "q1": "SELECT t.EMPNO, DEPT.DEPTNO AS DEPTNO0 FROM (SELECT * FROM EMP AS EMP WHERE EMP.EMPNO = 10) AS t INNER JOIN DEPT AS DEPT ON t.EMPNO < DEPT.DEPTNO GROUP BY t.EMPNO, DEPT.DEPTNO",
  "q2": "SELECT t1.EMPNO, DEPT0.DEPTNO AS DEPTNO0 FROM (SELECT * FROM EMP AS EMP0 WHERE EMP0.EMPNO = 10) AS t1 INNER JOIN DEPT AS DEPT0 ON t1.EMPNO < DEPT0.DEPTNO GROUP BY t1.EMPNO, DEPT0.DEPTNO"
},
{
  "name": "testPushAggregateThroughJoin4",
  "q1": "SELECT EMP.DEPTNO FROM EMP AS EMP INNER JOIN DEPT AS DEPT ON EMP.DEPTNO = DEPT.DEPTNO GROUP BY EMP.DEPTNO",
  "q2": "SELECT t0.DEPTNO FROM (SELECT EMP0.DEPTNO FROM EMP AS EMP0 GROUP BY EMP0.DEPTNO) AS t0 INNER JOIN DEPT AS DEPT0 ON t0.DEPTNO = DEPT0.DEPTNO"
},
{
  "name": "testPushAggregateThroughJoin5",
  "q1": "SELECT EMP.DEPTNO, DEPT.DEPTNO AS DEPTNO0 FROM EMP AS EMP INNER JOIN DEPT AS DEPT ON EMP.DEPTNO = DEPT.DEPTNO GROUP BY EMP.DEPTNO, DEPT.DEPTNO",
  "q2": "SELECT t0.DEPTNO, DEPT0.DEPTNO AS DEPTNO0 FROM (SELECT EMP0.DEPTNO FROM EMP AS EMP0 GROUP BY EMP0.DEPTNO) AS t0 INNER JOIN DEPT AS DEPT0 ON t0.DEPTNO = DEPT0.DEPTNO"
},
{
  "name": "testReduceConstants",
  "q1": "SELECT 1 + 2, t1.DEPTNO + (3 + 4), 5 + 6 + t1.DEPTNO, NULL, CASE WHEN 2 IS NOT NULL THEN 2 ELSE NULL END, ROW(7 + 8) FROM (SELECT DEPT.DEPTNO, DEPT.NAME, t.EMPNO, t.ENAME, t.JOB, t.MGR, t.HIREDATE, t.SAL, t.COMM, t.DEPTNO AS DEPTNO0, t.SLACKER FROM DEPT AS DEPT INNER JOIN (SELECT EMP.EMPNO, EMP.ENAME, EMP.JOB, EMP.MGR, EMP.HIREDATE, EMP.SAL, EMP.COMM, EMP.DEPTNO, EMP.SLACKER, EMP.DEPTNO + (5 - 5) AS $f9 FROM EMP AS EMP) AS t ON DEPT.DEPTNO = t.$f9) AS t0 WHERE t0.DEPTNO = 7 + 8 AND t0.DEPTNO = 8 + 7 AND t0.DEPTNO = CASE WHEN 2 IS NOT NULL THEN 2 ELSE NULL END",
  "q2": "SELECT 3, 22, 26, NULL, CAST(2 AS INTEGER), ROW(15) FROM (VALUES) AS t3"
},
{
  "name": "basePushAggThroughUnion",
  "q1": "SELECT t1.ENAME, SUM(t1.U) FROM (SELECT EMP.EMPNO, EMP.ENAME, EMP.JOB, EMP.MGR, EMP.HIREDATE, EMP.SAL, EMP.COMM, EMP.DEPTNO, EMP.SLACKER, NULL AS U FROM EMP AS EMP UNION ALL SELECT EMP0.EMPNO, EMP0.ENAME, EMP0.JOB, EMP0.MGR, EMP0.HIREDATE, EMP0.SAL, EMP0.COMM, EMP0.DEPTNO, EMP0.SLACKER, NULL AS U FROM EMP AS EMP0) AS t1 GROUP BY t1.ENAME",
  "q2": "SELECT t8.ENAME, SUM(SUM(NULL)) FROM (SELECT EMP1.ENAME, SUM(NULL) FROM EMP AS EMP1 GROUP BY EMP1.ENAME UNION ALL SELECT EMP2.ENAME, SUM(NULL) FROM EMP AS EMP2 GROUP BY EMP2.ENAME) AS t8 GROUP BY t8.ENAME"
},
{
  "name": "testMergeJoinFilter",
  "q1": "SELECT * FROM (SELECT DEPT.DEPTNO, EMP.ENAME FROM EMP AS EMP INNER JOIN DEPT AS DEPT ON EMP.DEPTNO = DEPT.DEPTNO AND DEPT.DEPTNO = 10) AS t WHERE t.DEPTNO = 10",
  "q2": "SELECT t1.DEPTNO, EMP0.ENAME FROM EMP AS EMP0 INNER JOIN (SELECT * FROM DEPT AS DEPT0 WHERE DEPT0.DEPTNO = 10) AS t1 ON EMP0.DEPTNO = t1.DEPTNO"
},
{
  "name": "testMergeUnionDistinct",
  "q1": "SELECT * FROM (SELECT * FROM EMP AS EMP WHERE EMP.DEPTNO = 10 UNION SELECT * FROM EMP AS EMP0 WHERE EMP0.DEPTNO = 20) AS t1 UNION SELECT * FROM EMP AS EMP1 WHERE EMP1.DEPTNO = 30",
  "q2": "SELECT * FROM EMP AS EMP2 WHERE EMP2.DEPTNO = 10 UNION SELECT * FROM EMP AS EMP3 WHERE EMP3.DEPTNO = 20 UNION SELECT * FROM EMP AS EMP4 WHERE EMP4.DEPTNO = 30"
},
{
  "name": "testStrengthenJoinType",
  "q1": "SELECT * FROM DEPT AS DEPT LEFT JOIN EMP AS EMP ON DEPT.DEPTNO = EMP.DEPTNO WHERE EMP.DEPTNO IS NOT NULL AND EMP.SAL > 100",
  "q2": "SELECT DEPT0.DEPTNO, DEPT0.NAME, CAST(t0.EMPNO AS INTEGER) AS EMPNO, CAST(t0.ENAME AS VARCHAR(20)) AS ENAME, CAST(t0.JOB AS VARCHAR(10)) AS JOB, t0.MGR, CAST(t0.HIREDATE AS TIMESTAMP(0)) AS HIREDATE, CAST(t0.SAL AS INTEGER) AS SAL, CAST(t0.COMM AS INTEGER) AS COMM, CAST(t0.DEPTNO AS INTEGER) AS DEPTNO0, CAST(t0.SLACKER AS BOOLEAN) AS SLACKER FROM DEPT AS DEPT0 INNER JOIN (SELECT * FROM EMP AS EMP0 WHERE EMP0.SAL > 100) AS t0 ON DEPT0.DEPTNO = t0.DEPTNO"
},
{
  "name": "testPushAggregateSumThroughJoin",
  "q1": "SELECT t.JOB, SUM(t.SAL) FROM (SELECT * FROM EMP AS EMP WHERE EMP.EMPNO = 10) AS t INNER JOIN DEPT AS DEPT ON t.JOB = DEPT.NAME GROUP BY t.JOB, DEPT.NAME",
  "q2": "SELECT t3.JOB, CAST(SUM(EMP0.SAL) * t4.$f1 AS INTEGER) FROM (SELECT EMP0.JOB, SUM(EMP0.SAL) FROM EMP AS EMP0 WHERE EMP0.EMPNO = 10 GROUP BY EMP0.JOB) AS t3 INNER JOIN (SELECT DEPT0.NAME, COUNT(*) AS $f1 FROM DEPT AS DEPT0 GROUP BY DEPT0.NAME) AS t4 ON t3.JOB = t4.NAME"
},
{
  "name": "testExpandFilterIn",
  "q1": "SELECT EMP.EMPNO FROM EMP AS EMP WHERE EMP.DEPTNO IN (SELECT EMP0.DEPTNO FROM EMP AS EMP0 WHERE EMP0.EMPNO < 20) OR EMP.SAL < 100",
  "q2": "SELECT EMP1.EMPNO FROM EMP AS EMP1 LEFT JOIN (SELECT EMP2.DEPTNO, TRUE AS i FROM EMP AS EMP2 WHERE EMP2.EMPNO < 20 GROUP BY EMP2.DEPTNO, TRUE) AS t6 ON EMP1.DEPTNO = t6.DEPTNO WHERE t6.i IS NOT NULL OR EMP1.SAL < 100"
},
{
  "name": "testReduceConstantsCaseEquals",
  "q1": "SELECT COUNT(*) FROM EMP AS EMP WHERE CASE WHEN EMP.DEPTNO = 20 THEN 2 WHEN EMP.DEPTNO = 10 THEN 1 ELSE 3 END = 1",
  "q2": "SELECT COUNT(*) FROM EMP AS EMP0 WHERE EMP0.DEPTNO = 10"
},
{
  "name": "testTransitiveInferenceNoPullUpExprs",
  "q1": "SELECT 1 FROM (SELECT * FROM EMP AS EMP WHERE EMP.DEPTNO = 7 OR EMP.DEPTNO = 9 OR EMP.COMM > 10) AS t INNER JOIN EMP AS EMP0 ON t.DEPTNO = EMP0.DEPTNO",
  "q2": "SELECT 1 FROM (SELECT * FROM EMP AS EMP1 WHERE EMP1.DEPTNO = 7 OR EMP1.DEPTNO = 9 OR EMP1.COMM > 10) AS t1 INNER JOIN EMP AS EMP2 ON t1.DEPTNO = EMP2.DEPTNO"
},
{
  "name": "testEmptyProject",
  "q1": "SELECT t0.EXPR$0 + t0.EXPR$1 + t0.EXPR$0 FROM (VALUES  (10, 1),  (30, 3)) AS t WHERE t.EXPR$0 + t.EXPR$1 > 50",
  "q2": "SELECT t3.X + t3.Y + t3.X FROM (VALUES) AS t3"
},
{
  "name": "testTransitiveInferenceConjunctInPullUp",
  "q1": "SELECT 1 FROM (SELECT * FROM EMP AS EMP WHERE EMP.DEPTNO = 7 OR EMP.DEPTNO = 9 OR EMP.DEPTNO > 10) AS t INNER JOIN EMP AS EMP0 ON t.DEPTNO = EMP0.DEPTNO",
  "q2": "SELECT 1 FROM (SELECT * FROM EMP AS EMP1 WHERE EMP1.DEPTNO = 7 OR EMP1.DEPTNO = 9 OR EMP1.DEPTNO > 10) AS t1 INNER JOIN (SELECT * FROM EMP AS EMP2 WHERE EMP2.DEPTNO = 7 OR EMP2.DEPTNO = 9 OR EMP2.DEPTNO > 10) AS t2 ON t1.DEPTNO = t2.DEPTNO"
},
{
  "name": "basePullConstantTroughAggregate",
  "q1": "SELECT EMP.DEPTNO, MAX(EMP.ENAME) FROM EMP AS EMP GROUP BY EMP.DEPTNO, 4",
  "q2": "SELECT EMP0.DEPTNO, MAX(EMP0.ENAME) FROM EMP AS EMP0 GROUP BY EMP0.DEPTNO"
},
{
  "name": "testUnionToDistinctRule",
  "q1": "SELECT * FROM DEPT AS DEPT UNION SELECT * FROM DEPT AS DEPT0",
  "q2": "SELECT t0.DEPTNO, t0.NAME FROM (SELECT * FROM DEPT AS DEPT1 UNION ALL SELECT * FROM DEPT AS DEPT2) AS t0 GROUP BY t0.DEPTNO, t0.NAME"
},
{
  "name": "testPushSemiJoinPastFilter",
  "q1": "SELECT EMP.ENAME FROM EMP AS EMP, DEPT AS DEPT WHERE EMP.DEPTNO = DEPT.DEPTNO AND EMP.ENAME = 'foo'",
  "q2": "SELECT t1.ENAME FROM (SELECT * FROM EMP AS EMP0 INNER JOIN DEPT AS DEPT0 ON EMP0.DEPTNO = DEPT0.DEPTNO WHERE EMP0.ENAME = 'foo') AS t1 INNER JOIN DEPT AS DEPT1 ON t1.DEPTNO = DEPT1.DEPTNO"
},
{
  "name": "testPullAggregateThroughUnion",
  "q1": "SELECT t3.DEPTNO, t3.JOB FROM (SELECT EMP.DEPTNO, EMP.JOB FROM EMP AS EMP GROUP BY EMP.DEPTNO, EMP.JOB UNION ALL SELECT EMP0.DEPTNO, EMP0.JOB FROM EMP AS EMP0 GROUP BY EMP0.DEPTNO, EMP0.JOB) AS t3 GROUP BY t3.DEPTNO, t3.JOB",
  "q2": "SELECT t7.DEPTNO, t7.JOB FROM (SELECT EMP1.DEPTNO, EMP1.JOB FROM EMP AS EMP1 UNION ALL SELECT EMP2.DEPTNO, EMP2.JOB FROM EMP AS EMP2) AS t7 GROUP BY t7.DEPTNO, t7.JOB"
},
{
  "name": "testPullConstantIntoFilter",
  "q1": "SELECT * FROM (SELECT * FROM EMP AS EMP WHERE EMP.DEPTNO = 10) AS t WHERE t.DEPTNO + 5 > t.EMPNO",
  "q2": "SELECT * FROM (SELECT * FROM EMP AS EMP0 WHERE EMP0.DEPTNO = 10) AS t1 WHERE 15 > t1.EMPNO"
},
{
  "name": "basePushAggThroughUnion",
  "q1": "SELECT t.ENAME, SUM(t.MGR) FROM (SELECT * FROM EMP AS EMP UNION ALL SELECT * FROM EMP AS EMP0) AS t GROUP BY t.ENAME",
  "q2": "SELECT t6.ENAME, SUM(SUM(EMP2.MGR)) FROM (SELECT EMP1.ENAME, SUM(EMP1.MGR) FROM EMP AS EMP1 GROUP BY EMP1.ENAME UNION ALL SELECT EMP2.ENAME, SUM(EMP2.MGR) FROM EMP AS EMP2 GROUP BY EMP2.ENAME) AS t6 GROUP BY t6.ENAME"
},
{
  "name": "testEmptyAggregate",
  "q1": "SELECT SUM(t.EMPNO) FROM (VALUES) AS t GROUP BY t.DEPTNO",
  "q2": "SELECT * FROM (VALUES) AS t2"
},
{
  "name": "testTransitiveInferencePullUpThruAlias",
  "q1": "SELECT 1 FROM (SELECT EMP.COMM AS DEPTNO FROM EMP AS EMP WHERE EMP.COMM > 7) AS t0 INNER JOIN EMP AS EMP0 ON t0.DEPTNO = EMP0.DEPTNO",
  "q2": "SELECT 1 FROM (SELECT EMP1.COMM AS DEPTNO FROM EMP AS EMP1 WHERE EMP1.COMM > 7) AS t3 INNER JOIN (SELECT * FROM EMP AS EMP2 WHERE EMP2.DEPTNO > 7) AS t4 ON t3.DEPTNO = t4.DEPTNO"
},
{
  "name": "testTransitiveInferenceAggregate",
  "q1": "SELECT 1 FROM (SELECT EMP.DEPTNO, COUNT(*) FROM EMP AS EMP WHERE EMP.DEPTNO > 7 GROUP BY EMP.DEPTNO) AS t1 INNER JOIN EMP AS EMP0 ON t1.DEPTNO = EMP0.DEPTNO",
  "q2": "SELECT 1 FROM (SELECT EMP1.DEPTNO, COUNT(*) FROM EMP AS EMP1 WHERE EMP1.DEPTNO > 7 GROUP BY EMP1.DEPTNO) AS t5 INNER JOIN (SELECT * FROM EMP AS EMP2 WHERE EMP2.DEPTNO > 7) AS t6 ON t5.DEPTNO = t6.DEPTNO"
},
{
  "name": "testEmptySortLimitZero",
  "q1": "SELECT * FROM EMP AS EMP ORDER BY EMP.DEPTNO FETCH NEXT 0 ROWS ONLY",
  "q2": "SELECT * FROM (VALUES) AS t1"
},
{
  "name": "testCastInAggregateExpandDistinctAggregatesRule",
  "q1": "SELECT t0.NAME, SUM(DISTINCT t0.EXPR$1), SUM(DISTINCT t0.EXPR$2) FROM (SELECT DEPT.NAME, COUNT(*) AS CN, SUM(DEPT.DEPTNO) AS SM FROM DEPT AS DEPT GROUP BY DEPT.NAME) AS t0 GROUP BY t0.NAME",
  "q2": "SELECT t3.NAME, CAST(SUM(t3.CN) AS BIGINT), CAST(SUM(t3.SM) AS INTEGER) FROM (SELECT DEPT0.NAME, COUNT(*) AS CN, SUM(DEPT0.DEPTNO) AS SM FROM DEPT AS DEPT0 GROUP BY DEPT0.NAME) AS t3 GROUP BY t3.NAME"
},
{
  "name": "testDistinctCount1",
  "q1": "SELECT EMP.DEPTNO, COUNT(DISTINCT EMP.ENAME) FROM EMP AS EMP GROUP BY EMP.DEPTNO",
  "q2": "SELECT COUNT(DISTINCT EMP.ENAME) AS DEPTNO, COUNT(t1.DEPTNO) FROM (SELECT EMP0.ENAME, EMP0.DEPTNO FROM EMP AS EMP0 GROUP BY EMP0.ENAME, EMP0.DEPTNO) AS t1 GROUP BY COUNT(DISTINCT EMP.ENAME)"
},
{
  "name": "testDistinctCount2",
  "q1": "SELECT EMP.DEPTNO, COUNT(DISTINCT EMP.ENAME), SUM(EMP.SAL) FROM EMP AS EMP GROUP BY EMP.DEPTNO",
  "q2": "SELECT EMP0.DEPTNO, COUNT(EMP0.ENAME), CAST(MIN(SUM(EMP0.SAL)) AS INTEGER) FROM EMP AS EMP0 GROUP BY EMP0.DEPTNO"
},
{
  "name": "testDistinctCount3",
  "q1": "SELECT COUNT(DISTINCT EMP.DEPTNO), SUM(EMP.SAL) FROM EMP AS EMP GROUP BY EMP.DEPTNO",
  "q2": "SELECT COUNT(EMP0.DEPTNO), CAST(MIN(SUM(EMP0.SAL)) AS INTEGER) FROM EMP AS EMP0 GROUP BY EMP0.DEPTNO"
},
{
  "name": "testExpandProjectIn",
  "q1": "SELECT EMP.EMPNO, EMP.DEPTNO IN (SELECT EMP0.DEPTNO FROM EMP AS EMP0 WHERE EMP0.EMPNO < 20) AS D FROM EMP AS EMP",
  "q2": "SELECT EMP1.EMPNO, CASE WHEN t5.i IS NOT NULL THEN TRUE ELSE FALSE END AS D FROM EMP AS EMP1 LEFT JOIN (SELECT EMP2.DEPTNO, TRUE AS i FROM EMP AS EMP2 WHERE EMP2.EMPNO < 20 GROUP BY EMP2.DEPTNO, TRUE) AS t5 ON EMP1.DEPTNO = t5.DEPTNO"
},
{
  "name": "testReduceNullableCase2",
  "q1": "SELECT EMP.DEPTNO, EMP.ENAME, CASE WHEN 1 = 2 THEN CAST(SUBSTRING(EMP.ENAME FROM 1 FOR 2) AS VARCHAR(20)) ELSE NULL END FROM EMP AS EMP GROUP BY EMP.DEPTNO, EMP.ENAME, CASE WHEN 1 = 2 THEN CAST(SUBSTRING(EMP.ENAME FROM 1 FOR 2) AS VARCHAR(20)) ELSE NULL END",
  "q2": "SELECT EMP0.DEPTNO, EMP0.ENAME, NULL FROM EMP AS EMP0 GROUP BY EMP0.DEPTNO, EMP0.ENAME, NULL"
},
{
  "name": "basePushAggThroughUnion",
  "q1": "SELECT t.DEPTNO, t.JOB, COUNT(*) FROM (SELECT * FROM EMP AS EMP UNION ALL SELECT * FROM EMP AS EMP0) AS t GROUP BY t.DEPTNO, t.JOB",
  "q2": "SELECT t6.DEPTNO, t6.JOB, SUM(COUNT(*)) FROM (SELECT EMP1.DEPTNO, EMP1.JOB, COUNT(*) FROM EMP AS EMP1 GROUP BY EMP1.DEPTNO, EMP1.JOB UNION ALL SELECT EMP2.DEPTNO, EMP2.JOB, COUNT(*) FROM EMP AS EMP2 GROUP BY EMP2.DEPTNO, EMP2.JOB) AS t6 GROUP BY t6.DEPTNO, t6.JOB"
},
{
  "name": "testDistinctNonDistinctAggregates",
  "q1": "SELECT EMP.EMPNO, COUNT(*), AVG(DISTINCT DEPT.DEPTNO) FROM EMP AS EMP INNER JOIN DEPT AS DEPT ON EMP.DEPTNO = DEPT.DEPTNO GROUP BY EMP.EMPNO",
  "q2": "SELECT t2.EMPNO, SUM(AVG(DISTINCT DEPT.DEPTNO)), AVG(SUM(AVG(DISTINCT DEPT.DEPTNO))) FROM (SELECT EMP0.EMPNO, DEPT0.DEPTNO AS DEPTNO0, COUNT(*) FROM EMP AS EMP0 INNER JOIN DEPT AS DEPT0 ON EMP0.DEPTNO = DEPT0.DEPTNO GROUP BY EMP0.EMPNO, DEPT0.DEPTNO) AS t2 GROUP BY t2.EMPNO"
},
{
  "name": "testMergeSetOpMixed",
  "q1": "SELECT * FROM EMP AS EMP WHERE EMP.DEPTNO = 10 UNION SELECT * FROM (SELECT * FROM EMP AS EMP0 WHERE EMP0.DEPTNO = 20 INTERSECT SELECT * FROM EMP AS EMP1 WHERE EMP1.DEPTNO = 30) AS t2",
  "q2": "SELECT * FROM EMP AS EMP2 WHERE EMP2.DEPTNO = 10 UNION SELECT * FROM (SELECT * FROM EMP AS EMP3 WHERE EMP3.DEPTNO = 20 INTERSECT SELECT * FROM EMP AS EMP4 WHERE EMP4.DEPTNO = 30) AS t7"
},
{
  "name": "testDistinctNonDistinctAggregatesWithGrouping1",
  "q1": "SELECT EMP.DEPTNO, SUM(EMP.DEPTNO), SUM(DISTINCT EMP.SAL), MAX(EMP.DEPTNO), MAX(EMP.COMM) FROM EMP AS EMP GROUP BY EMP.DEPTNO",
  "q2": "SELECT t2.DEPTNO, SUM(SUM(DISTINCT EMP.SAL)), SUM(SUM(SUM(DISTINCT EMP.SAL))), MAX(MAX(EMP0.DEPTNO)), MAX(MAX(EMP0.COMM)) FROM (SELECT EMP0.DEPTNO, EMP0.SAL, SUM(EMP0.DEPTNO), MAX(EMP0.DEPTNO), MAX(EMP0.COMM) FROM EMP AS EMP0 GROUP BY EMP0.DEPTNO, EMP0.SAL) AS t2 GROUP BY t2.DEPTNO"
},
{
  "name": "testDistinctNonDistinctAggregatesWithGrouping2",
  "q1": "SELECT EMP.DEPTNO, COUNT(*), SUM(DISTINCT EMP.SAL) FROM EMP AS EMP GROUP BY EMP.DEPTNO",
  "q2": "SELECT t2.DEPTNO, SUM(SUM(DISTINCT EMP.SAL)), SUM(SUM(SUM(DISTINCT EMP.SAL))) FROM (SELECT EMP0.DEPTNO, EMP0.SAL, COUNT(*) FROM EMP AS EMP0 GROUP BY EMP0.DEPTNO, EMP0.SAL) AS t2 GROUP BY t2.DEPTNO"
},
{
  "name": "testReduceConstantsIsNotNull",
  "q1": "SELECT EMP.EMPNO FROM EMP AS EMP WHERE EMP.EMPNO = 10 AND EMP.EMPNO IS NOT NULL",
  "q2": "SELECT EMP0.EMPNO FROM EMP AS EMP0 WHERE EMP0.EMPNO = 10"
},
{
  "name": "basePushAggThroughUnion",
  "q1": "SELECT t.DEPTNO, t.JOB, MIN(t.EMPNO) FROM (SELECT * FROM EMP AS EMP UNION ALL SELECT * FROM EMP AS EMP0) AS t GROUP BY t.DEPTNO, t.JOB",
  "q2": "SELECT t6.DEPTNO, t6.JOB, MIN(MIN(EMP2.EMPNO)) FROM (SELECT EMP1.DEPTNO, EMP1.JOB, MIN(EMP1.EMPNO) FROM EMP AS EMP1 GROUP BY EMP1.DEPTNO, EMP1.JOB UNION ALL SELECT EMP2.DEPTNO, EMP2.JOB, MIN(EMP2.EMPNO) FROM EMP AS EMP2 GROUP BY EMP2.DEPTNO, EMP2.JOB) AS t6 GROUP BY t6.DEPTNO, t6.JOB"
},
{
  "name": "basePullConstantTroughAggregate",
  "q1": "SELECT 4, 2 + 3, MAX(EMP.MGR) FROM EMP AS EMP GROUP BY 4, 2 + 3",
  "q2": "SELECT 4, 2 + 3, MAX(EMP0.MGR) FROM EMP AS EMP0 GROUP BY 4"
},
{
  "name": "basePullConstantTroughAggregate",
  "q1": "SELECT EMP.DEPTNO, MAX(EMP.MGR) FROM EMP AS EMP GROUP BY EMP.DEPTNO, 4, 2 + 3, EMP.DEPTNO + 42",
  "q2": "SELECT EMP0.DEPTNO, MAX(EMP0.MGR) FROM EMP AS EMP0 GROUP BY EMP0.DEPTNO, EMP0.DEPTNO + 42"
},
{
  "name": "testEmptyIntersect",
  "q1": "SELECT * FROM (SELECT * FROM (VALUES  (30, 3)) AS t INTERSECT SELECT * FROM (VALUES  (10, 1),  (30, 3)) AS t0 WHERE t0.EXPR$0 > 50) AS t2 INTERSECT SELECT * FROM (VALUES  (30, 3)) AS t3",
  "q2": "SELECT * FROM (VALUES) AS t5"
},
{
  "name": "testPushProjectPastRightJoinSwap",
  "q1": "SELECT COUNT(*), CASE WHEN EMP.SAL < 11 THEN 11 ELSE -1 * EMP.SAL END FROM BONUS AS BONUS RIGHT JOIN EMP AS EMP ON BONUS.ENAME = EMP.ENAME GROUP BY CASE WHEN EMP.SAL < 11 THEN 11 ELSE -1 * EMP.SAL END",
  "q2": "SELECT COUNT(*), t3.CASE FROM (SELECT BONUS0.ENAME FROM BONUS AS BONUS0) AS t2 RIGHT JOIN (SELECT EMP0.ENAME, CASE WHEN EMP0.SAL < 11 THEN 11 ELSE -1 * EMP0.SAL END AS CASE FROM EMP AS EMP0) AS t3 ON t2.ENAME = t3.ENAME GROUP BY t3.CASE"
},
{
  "name": "testPullConstantIntoProject",
  "q1": "SELECT EMP.DEPTNO, EMP.DEPTNO + 1, EMP.EMPNO + EMP.DEPTNO FROM EMP AS EMP WHERE EMP.DEPTNO = 10",
  "q2": "SELECT 10 AS DEPTNO, 11, EMP0.EMPNO + 10 FROM EMP AS EMP0 WHERE EMP0.DEPTNO = 10"
},
{
  "name": "testTransitiveInferenceUnionAlwaysTrue",
  "q1": "SELECT * FROM (SELECT EMP.DEPTNO FROM EMP AS EMP WHERE EMP.DEPTNO < 4) AS t0 INNER JOIN (SELECT EMP0.DEPTNO FROM EMP AS EMP0 WHERE EMP0.DEPTNO > 7 UNION ALL SELECT EMP1.DEPTNO FROM EMP AS EMP1) AS t4 ON t0.DEPTNO = t4.DEPTNO",
  "q2": "SELECT * FROM (SELECT EMP2.DEPTNO FROM EMP AS EMP2 WHERE EMP2.DEPTNO < 4) AS t6 INNER JOIN (SELECT * FROM (SELECT EMP3.DEPTNO FROM EMP AS EMP3 WHERE EMP3.DEPTNO > 7 UNION ALL SELECT EMP4.DEPTNO FROM EMP AS EMP4) AS t10 WHERE t10.DEPTNO < 4) AS t11 ON t6.DEPTNO = t11.DEPTNO"
},
{
  "name": "testReduceCompositeInSubQuery",
  "q1": "SELECT * FROM EMP AS EMP WHERE (EMP.EMPNO, EMP.DEPTNO) IN (SELECT EMP0.EMPNO, EMP0.DEPTNO FROM EMP AS EMP0 GROUP BY EMP0.EMPNO, EMP0.DEPTNO) OR EMP.DEPTNO < 40 + 60",
  "q2": "SELECT * FROM EMP AS EMP1 WHERE (EMP1.EMPNO, EMP1.DEPTNO) IN (SELECT EMP2.EMPNO, EMP2.DEPTNO FROM EMP AS EMP2 GROUP BY EMP2.EMPNO, EMP2.DEPTNO) OR EMP1.DEPTNO < 100"
},
{
  "name": "testMergeIntersect",
  "q1": "SELECT * FROM (SELECT * FROM EMP AS EMP WHERE EMP.DEPTNO = 10 INTERSECT SELECT * FROM EMP AS EMP0 WHERE EMP0.DEPTNO = 20) AS t1 INTERSECT SELECT * FROM EMP AS EMP1 WHERE EMP1.DEPTNO = 30",
  "q2": "SELECT * FROM EMP AS EMP2 WHERE EMP2.DEPTNO = 10 INTERSECT SELECT * FROM EMP AS EMP3 WHERE EMP3.DEPTNO = 20 INTERSECT SELECT * FROM EMP AS EMP4 WHERE EMP4.DEPTNO = 30"
},
{
  "name": "basePushAggThroughUnion",
  "q1": "SELECT t1.ENAME, SUM(t1.U) FROM (SELECT EMP.EMPNO, EMP.ENAME, EMP.JOB, EMP.MGR, EMP.HIREDATE, EMP.SAL, EMP.COMM, EMP.DEPTNO, EMP.SLACKER, 2 AS U FROM EMP AS EMP UNION ALL SELECT EMP0.EMPNO, EMP0.ENAME, EMP0.JOB, EMP0.MGR, EMP0.HIREDATE, EMP0.SAL, EMP0.COMM, EMP0.DEPTNO, EMP0.SLACKER, 3 AS U FROM EMP AS EMP0) AS t1 GROUP BY t1.ENAME",
  "q2": "SELECT t8.ENAME, SUM(SUM(3)) FROM (SELECT EMP1.ENAME, SUM(2) FROM EMP AS EMP1 GROUP BY EMP1.ENAME UNION ALL SELECT EMP2.ENAME, SUM(3) FROM EMP AS EMP2 GROUP BY EMP2.ENAME) AS t8 GROUP BY t8.ENAME"
},
{
  "name": "testAddRedundantSemiJoinRule",
  "q1": "SELECT 1 FROM EMP AS EMP INNER JOIN DEPT AS DEPT ON EMP.DEPTNO = DEPT.DEPTNO",
  "q2": "SELECT 1 FROM EMP AS EMP0 INNER JOIN DEPT AS DEPT0 ON EMP0.DEPTNO = DEPT0.DEPTNO INNER JOIN DEPT AS DEPT1 ON EMP0.DEPTNO = DEPT1.DEPTNO"
},
{
  "name": "testExpandProjectExists",
  "q1": "SELECT EMP.EMPNO, EXISTS (SELECT * FROM EMP AS EMP0 WHERE EMP0.EMPNO < 20) AS D FROM EMP AS EMP",
  "q2": "SELECT EMP1.EMPNO, CASE WHEN t3.i IS NOT NULL THEN TRUE ELSE FALSE END AS D FROM EMP AS EMP1 LEFT JOIN (SELECT TRUE AS i FROM EMP AS EMP2 WHERE EMP2.EMPNO < 20 GROUP BY TRUE) AS t3 ON TRUE"
},
{
  "name": "testRemoveSemiJoinWithFilter",
  "q1": "SELECT EMP.ENAME FROM EMP AS EMP, DEPT AS DEPT WHERE EMP.DEPTNO = DEPT.DEPTNO AND EMP.ENAME = 'foo'",
  "q2": "SELECT t1.ENAME FROM (SELECT * FROM EMP AS EMP0 WHERE EMP0.ENAME = 'foo') AS t1 INNER JOIN DEPT AS DEPT0 ON t1.DEPTNO = DEPT0.DEPTNO"
},
{
  "name": "testRightOuterJoinSimplificationToInner",
  "q1": "SELECT 1 FROM DEPT AS DEPT RIGHT JOIN EMP AS EMP ON DEPT.DEPTNO = EMP.DEPTNO WHERE DEPT.NAME = 'Charlie'",
  "q2": "SELECT 1 FROM (SELECT * FROM DEPT AS DEPT0 WHERE DEPT0.NAME = 'Charlie') AS t1 INNER JOIN EMP AS EMP0 ON t1.DEPTNO = EMP0.DEPTNO"
},
{
  "name": "testDistinctCountMixed",
  "q1": "SELECT EMP.DEPTNO, COUNT(DISTINCT EMP.DEPTNO, EMP.JOB) AS CDDJ, SUM(EMP.SAL) AS S FROM EMP AS EMP GROUP BY EMP.DEPTNO",
  "q2": "SELECT EMP0.DEPTNO, COUNT(EMP0.DEPTNO, EMP0.JOB) AS CDDJ, CAST(MIN(SUM(EMP0.SAL)) AS INTEGER) AS S FROM EMP AS EMP0 GROUP BY EMP0.DEPTNO"
},
{
  "name": "testPushJoinCondDownToProject",
  "q1": "SELECT DEPT.DEPTNO, EMP.DEPTNO AS DEPTNO0 FROM DEPT AS DEPT, EMP AS EMP WHERE DEPT.DEPTNO + 10 = EMP.DEPTNO * 2",
  "q2": "SELECT t1.DEPTNO, t2.DEPTNO AS DEPTNO0 FROM (SELECT DEPT0.DEPTNO, DEPT0.NAME, DEPT0.DEPTNO + 10 AS $f2 FROM DEPT AS DEPT0) AS t1 INNER JOIN (SELECT EMP0.EMPNO, EMP0.ENAME, EMP0.JOB, EMP0.MGR, EMP0.HIREDATE, EMP0.SAL, EMP0.COMM, EMP0.DEPTNO, EMP0.SLACKER, EMP0.DEPTNO * 2 AS $f9 FROM EMP AS EMP0) AS t2 ON t1.$f2 = t2.$f9"
},
{
  "name": "testRemoveSemiJoinRightWithFilter",
  "q1": "SELECT EMP.ENAME FROM EMP AS EMP, DEPT AS DEPT, EMP AS EMP0 WHERE EMP.DEPTNO = DEPT.DEPTNO AND DEPT.DEPTNO = EMP0.DEPTNO AND DEPT.NAME = 'foo'",
  "q2": "SELECT EMP1.ENAME FROM EMP AS EMP1 INNER JOIN (SELECT * FROM DEPT AS DEPT0 WHERE DEPT0.NAME = 'foo') AS t1 ON EMP1.DEPTNO = t1.DEPTNO INNER JOIN EMP AS EMP2 ON t1.DEPTNO = EMP2.DEPTNO"
},
{
  "name": "testFullOuterJoinSimplificationToLeftOuter",
  "q1": "SELECT 1 FROM DEPT AS DEPT FULL JOIN EMP AS EMP ON DEPT.DEPTNO = EMP.DEPTNO WHERE DEPT.NAME = 'Charlie'",
  "q2": "SELECT 1 FROM (SELECT * FROM DEPT AS DEPT0 WHERE DEPT0.NAME = 'Charlie') AS t1 LEFT JOIN EMP AS EMP0 ON t1.DEPTNO = EMP0.DEPTNO"
},
{
  "name": "basePullConstantTroughAggregate",
  "q1": "SELECT EMP.DEPTNO, MAX(EMP.MGR) FROM EMP AS EMP GROUP BY 4, EMP.DEPTNO",
  "q2": "SELECT EMP0.DEPTNO, MAX(EMP0.MGR) FROM EMP AS EMP0 GROUP BY EMP0.DEPTNO"
},
{
  "name": "testTransitiveInferenceUnion",
  "q1": "SELECT 1 FROM (SELECT EMP.DEPTNO FROM EMP AS EMP WHERE EMP.DEPTNO > 7 UNION ALL SELECT EMP0.DEPTNO FROM EMP AS EMP0 WHERE EMP0.DEPTNO > 10) AS t3 INNER JOIN EMP AS EMP1 ON t3.DEPTNO = EMP1.DEPTNO",
  "q2": "SELECT 1 FROM (SELECT EMP2.DEPTNO FROM EMP AS EMP2 WHERE EMP2.DEPTNO > 7 UNION ALL SELECT EMP3.DEPTNO FROM EMP AS EMP3 WHERE EMP3.DEPTNO > 10) AS t9 INNER JOIN (SELECT * FROM EMP AS EMP4 WHERE EMP4.DEPTNO > 7 OR EMP4.DEPTNO > 10) AS t10 ON t9.DEPTNO = t10.DEPTNO"
},
{
  "name": "testPullConstantIntoJoin",
  "q1": "SELECT * FROM (SELECT * FROM EMP AS EMP WHERE EMP.EMPNO = 10) AS t LEFT JOIN DEPT AS DEPT ON t.EMPNO = DEPT.DEPTNO",
  "q2": "SELECT * FROM (SELECT * FROM EMP AS EMP0 WHERE EMP0.EMPNO = 10) AS t0 LEFT JOIN (SELECT * FROM DEPT AS DEPT0 WHERE DEPT0.DEPTNO = 10) AS t1 ON TRUE"
},
{
  "name": "testReduceConstantsCaseEquals2",
  "q1": "SELECT COUNT(*) FROM EMP AS EMP WHERE CASE WHEN EMP.DEPTNO = 20 THEN 2 WHEN EMP.DEPTNO = 10 THEN 1 ELSE NULL END = 1",
  "q2": "SELECT COUNT(*) FROM EMP AS EMP0 WHERE EMP0.DEPTNO = 10"
},
{
  "name": "testReduceConstantsCaseEquals3",
  "q1": "SELECT COUNT(*) FROM EMP AS EMP WHERE CASE WHEN EMP.DEPTNO = 30 THEN 1 WHEN EMP.DEPTNO = 20 THEN 2 WHEN EMP.DEPTNO = 10 THEN 1 WHEN EMP.DEPTNO = 30 THEN 111 ELSE 0 END = 1",
  "q2": "SELECT COUNT(*) FROM EMP AS EMP0 WHERE EMP0.DEPTNO = 30 OR EMP0.DEPTNO = 10"
},
{
  "name": "testExpandJoinScalar",
  "q1": "SELECT EMP.EMPNO FROM EMP AS EMP LEFT JOIN DEPT AS DEPT ON (((SELECT EMP0.DEPTNO FROM EMP AS EMP0 WHERE EMP0.EMPNO < 20))) < (((SELECT EMP1.DEPTNO FROM EMP AS EMP1 WHERE EMP1.EMPNO > 100)))",
  "q2": "SELECT EMP2.EMPNO FROM EMP AS EMP2 LEFT JOIN (DEPT AS DEPT0 LEFT JOIN (SELECT SINGLE_VALUE(EMP3.DEPTNO) AS $f0 FROM EMP AS EMP3 WHERE EMP3.EMPNO < 20) AS t6 ON TRUE LEFT JOIN (SELECT SINGLE_VALUE(EMP4.DEPTNO) AS $f0 FROM EMP AS EMP4 WHERE EMP4.EMPNO > 100) AS t9 ON TRUE) ON t6.$f0 < t9.$f0"
},
{
  "name": "basePullConstantTroughAggregate",
  "q1": "SELECT 4, 2 + 3, MAX(5) FROM EMP AS EMP GROUP BY 4, 2 + 3",
  "q2": "SELECT 4, 2 + 3, MAX(5) FROM EMP AS EMP0 GROUP BY 4"
},
{
  "name": "testSwapOuterJoin",
  "q1": "SELECT 1 FROM DEPT AS DEPT LEFT JOIN EMP AS EMP ON DEPT.DEPTNO = EMP.DEPTNO",
  "q2": "SELECT 1 FROM EMP AS EMP0 RIGHT JOIN DEPT AS DEPT0 ON EMP0.DEPTNO = DEPT0.DEPTNO"
},
{
  "name": "testPushJoinThroughUnionOnLeft",
  "q1": "SELECT t.SAL FROM (SELECT * FROM EMP AS EMP UNION ALL SELECT * FROM EMP AS EMP0) AS t, EMP AS EMP1",
  "q2": "SELECT t1.SAL FROM (SELECT * FROM EMP AS EMP2, EMP AS EMP3 UNION ALL SELECT * FROM EMP AS EMP4, EMP AS EMP5) AS t1"
},
{
  "name": "testMergeUnionMixed2",
  "q1": "SELECT * FROM (SELECT * FROM EMP AS EMP WHERE EMP.DEPTNO = 10 UNION ALL SELECT * FROM EMP AS EMP0 WHERE EMP0.DEPTNO = 20) AS t1 UNION SELECT * FROM EMP AS EMP1 WHERE EMP1.DEPTNO = 30",
  "q2": "SELECT * FROM EMP AS EMP2 WHERE EMP2.DEPTNO = 10 UNION SELECT * FROM EMP AS EMP3 WHERE EMP3.DEPTNO = 20 UNION SELECT * FROM EMP AS EMP4 WHERE EMP4.DEPTNO = 30"
},
{
  "name": "testPushFilterPastAggThree",
  "q1": "SELECT EMP.DEPTNO FROM EMP AS EMP GROUP BY EMP.DEPTNO HAVING COUNT(*) > 1",
  "q2": "SELECT EMP0.DEPTNO FROM EMP AS EMP0 GROUP BY EMP0.DEPTNO HAVING COUNT(*) > 1"
},
{
  "name": "testReduceConstantsEliminatesFilter",
  "q1": "SELECT * FROM (VALUES  (1, 2)) AS t WHERE 1 + 2 > 3 + NULL",
  "q2": "SELECT * FROM (VALUES) AS t1"
},
{
  "name": "testExpandFilterExists",
  "q1": "SELECT EMP.EMPNO FROM EMP AS EMP WHERE EXISTS (SELECT * FROM EMP AS EMP0 WHERE EMP0.EMPNO < 20) OR EMP.SAL < 100",
  "q2": "SELECT EMP1.EMPNO FROM EMP AS EMP1 LEFT JOIN (SELECT TRUE AS i FROM EMP AS EMP2 WHERE EMP2.EMPNO < 20 GROUP BY TRUE) AS t4 ON TRUE WHERE t4.i IS NOT NULL OR EMP1.SAL < 100"
},
{
  "name": "testAggregateProjectPullUpConstants",
  "q1": "SELECT EMP.JOB, EMP.EMPNO, EMP.SAL, SUM(EMP.SAL) AS S FROM EMP AS EMP WHERE EMP.EMPNO = 10 GROUP BY EMP.JOB, EMP.EMPNO, EMP.SAL",
  "q2": "SELECT EMP0.JOB, 10 AS EMPNO, EMP0.SAL, SUM(EMP0.SAL) AS S FROM EMP AS EMP0 WHERE EMP0.EMPNO = 10 GROUP BY EMP0.JOB, EMP0.SAL"
},
{
  "name": "testPushProjectPastFilter2",
  "q1": "SELECT COUNT(*) FROM EMP AS EMP WHERE CASE WHEN EMP.MGR < 10 THEN TRUE ELSE FALSE END",
  "q2": "SELECT COUNT(*) FROM (SELECT EMP0.MGR FROM EMP AS EMP0) AS t2 WHERE t2.MGR < 10"
},
{
  "name": "testSemiJoinReduceConstants",
  "q1": "SELECT t0.SAL FROM (SELECT * FROM (SELECT EMP.SAL, EMP.DEPTNO FROM EMP AS EMP) AS t WHERE t.DEPTNO = 200) AS t0 INNER JOIN (SELECT t2.DEPTNO FROM (SELECT EMP0.SAL, EMP0.DEPTNO FROM EMP AS EMP0) AS t1 WHERE t1.SAL = 100) AS t3 ON t0.DEPTNO = t3.DEPTNO",
  "q2": "SELECT t6.SAL FROM (SELECT * FROM (SELECT EMP1.SAL, EMP1.DEPTNO FROM EMP AS EMP1) AS t5 WHERE t5.DEPTNO = 200) AS t6 INNER JOIN (SELECT t8.DEPTNO FROM (SELECT EMP2.SAL, EMP2.DEPTNO FROM EMP AS EMP2) AS t7 WHERE t7.SAL = 100) AS t9 ON t6.DEPTNO = t9.DEPTNO"
},
{
  "name": "testExpandProjectScalar",
  "q1": "SELECT EMP.EMPNO, (((SELECT EMP0.DEPTNO FROM EMP AS EMP0 WHERE EMP0.EMPNO < 20))) AS D FROM EMP AS EMP",
  "q2": "SELECT EMP1.EMPNO, t4.$f0 AS D FROM EMP AS EMP1 LEFT JOIN (SELECT SINGLE_VALUE(EMP2.DEPTNO) AS $f0 FROM EMP AS EMP2 WHERE EMP2.EMPNO < 20) AS t4 ON TRUE"
},
{
  "name": "testDistinctCountMultipleNoGroup",
  "q1": "SELECT COUNT(DISTINCT EMP.ENAME), COUNT(DISTINCT EMP.JOB) FROM EMP AS EMP",
  "q2": "SELECT COUNT(EMP0.ENAME), COUNT(EMP0.JOB) FROM EMP AS EMP0 GROUP BY EMP0.ENAME, EMP0.JOB"
},
{
  "name": "testExpandProjectInNullable",
  "q1": "SELECT EMP.EMPNO, CASE WHEN TRUE THEN CAST(EMP.DEPTNO AS INTEGER) ELSE NULL END IN (SELECT t1.DEPTNO FROM (SELECT EMP0.EMPNO, CASE WHEN TRUE THEN CAST(EMP0.DEPTNO AS INTEGER) ELSE NULL END AS DEPTNO FROM EMP AS EMP0) AS t0 WHERE t0.EMPNO < 20) AS D FROM EMP AS EMP",
  "q2": "SELECT t4.EMPNO, CASE WHEN t8.c = 0 THEN FALSE WHEN t13.i IS NOT NULL THEN TRUE WHEN t4.DEPTNO IS NULL THEN NULL WHEN t8.ck < t8.c THEN NULL ELSE FALSE END AS D FROM (SELECT EMP1.EMPNO, CASE WHEN TRUE THEN CAST(EMP1.DEPTNO AS INTEGER) ELSE NULL END AS DEPTNO FROM EMP AS EMP1) AS t4, (SELECT COUNT(*) AS c, COUNT(t6.DEPTNO) AS ck FROM (SELECT EMP2.EMPNO, CASE WHEN TRUE THEN CAST(EMP2.DEPTNO AS INTEGER) ELSE NULL END AS DEPTNO FROM EMP AS EMP2) AS t5 WHERE t5.EMPNO < 20) AS t8 LEFT JOIN (SELECT t10.DEPTNO, TRUE AS i FROM (SELECT EMP3.EMPNO, CASE WHEN TRUE THEN CAST(EMP3.DEPTNO AS INTEGER) ELSE NULL END AS DEPTNO FROM EMP AS EMP3) AS t9 WHERE t9.EMPNO < 20 GROUP BY t10.DEPTNO, TRUE) AS t13 ON t4.DEPTNO = t13.DEPTNO"
},
{
  "name": "testPullFilterThroughAggregate",
  "q1": "SELECT t0.ENAME, t0.SAL, t0.DEPTNO FROM (SELECT EMP.ENAME, EMP.SAL, EMP.DEPTNO FROM EMP AS EMP) AS t WHERE t.SAL > 5000 GROUP BY t0.ENAME, t0.SAL, t0.DEPTNO",
  "q2": "SELECT EMP0.ENAME, EMP0.SAL, EMP0.DEPTNO FROM EMP AS EMP0 GROUP BY EMP0.ENAME, EMP0.SAL, EMP0.DEPTNO HAVING EMP0.SAL > 5000"
},
{
  "name": "testAggregateConstantKeyRule2",
  "q1": "SELECT COUNT(*) AS C FROM EMP AS EMP WHERE EMP.DEPTNO = 10 GROUP BY EMP.DEPTNO",
  "q2": "SELECT COUNT(*) AS C FROM EMP AS EMP0 WHERE EMP0.DEPTNO = 10 GROUP BY EMP0.DEPTNO"
},
{
  "name": "testAggregateConstantKeyRule3",
  "q1": "SELECT EMP.JOB FROM EMP AS EMP WHERE EMP.SAL IS NULL AND EMP.JOB = 'Clerk' GROUP BY EMP.SAL, EMP.JOB HAVING COUNT(*) > 3",
  "q2": "SELECT t8.JOB FROM (SELECT EMP0.SAL, 'Clerk' AS JOB, COUNT(*) AS $f2 FROM EMP AS EMP0 WHERE EMP0.SAL IS NULL AND EMP0.JOB = 'Clerk' GROUP BY EMP0.SAL) AS t7 WHERE t7.$f2 > 3"
},
{
  "name": "testPullConstantIntoJoin2",
  "q1": "SELECT t0.EMPNO, t0.ENAME, t0.JOB, t0.MGR, t0.HIREDATE, t0.SAL, t0.COMM, t0.DEPTNO, t0.SLACKER, t1.DEPTNO AS DEPTNO0, t1.NAME FROM (SELECT EMP.EMPNO, EMP.ENAME, EMP.JOB, EMP.MGR, EMP.HIREDATE, EMP.SAL, EMP.COMM, EMP.DEPTNO, EMP.SLACKER, EMP.DEPTNO + EMP.EMPNO AS $f9 FROM EMP AS EMP WHERE EMP.EMPNO = 10) AS t0 INNER JOIN (SELECT DEPT.DEPTNO, DEPT.NAME, DEPT.DEPTNO + 5 AS $f2 FROM DEPT AS DEPT) AS t1 ON t0.EMPNO = t1.DEPTNO AND t0.$f9 = t1.$f2",
  "q2": "SELECT 10 AS EMPNO, t5.ENAME, t5.JOB, t5.MGR, t5.HIREDATE, t5.SAL, t5.COMM, t5.DEPTNO, t5.SLACKER, 10 AS DEPTNO0, t7.NAME FROM (SELECT 10 AS EMPNO, EMP0.ENAME, EMP0.JOB, EMP0.MGR, EMP0.HIREDATE, EMP0.SAL, EMP0.COMM, EMP0.DEPTNO, EMP0.SLACKER, EMP0.DEPTNO + 10 AS $f9 FROM EMP AS EMP0 WHERE EMP0.EMPNO = 10) AS t5 INNER JOIN (SELECT 10 AS DEPTNO, DEPT0.NAME, 15 AS $f2 FROM DEPT AS DEPT0 WHERE DEPT0.DEPTNO = 10) AS t7 ON t5.$f9 = 15"
},
{
  "name": "testPushProjectPastInnerJoinStrong",
  "q1": "SELECT COUNT(*), CASE WHEN EMP.SAL < 11 THEN -1 * EMP.SAL ELSE EMP.SAL END FROM EMP AS EMP INNER JOIN BONUS AS BONUS ON EMP.ENAME = BONUS.ENAME GROUP BY CASE WHEN EMP.SAL < 11 THEN -1 * EMP.SAL ELSE EMP.SAL END",
  "q2": "SELECT COUNT(*), t2.CASE FROM (SELECT EMP0.ENAME, CASE WHEN EMP0.SAL < 11 THEN -1 * EMP0.SAL ELSE EMP0.SAL END AS CASE FROM EMP AS EMP0) AS t2 INNER JOIN (SELECT BONUS0.ENAME FROM BONUS AS BONUS0) AS t3 ON t2.ENAME = t3.ENAME GROUP BY t2.CASE"
},
{
  "name": "testPushProjectPastLeftJoinSwap",
  "q1": "SELECT COUNT(*), CASE WHEN EMP.SAL < 11 THEN 11 ELSE -1 * EMP.SAL END FROM BONUS AS BONUS LEFT JOIN EMP AS EMP ON BONUS.ENAME = EMP.ENAME GROUP BY CASE WHEN EMP.SAL < 11 THEN 11 ELSE -1 * EMP.SAL END",
  "q2": "SELECT COUNT(*), CASE WHEN t3.< THEN 11 ELSE t3.* END FROM (SELECT BONUS0.ENAME FROM BONUS AS BONUS0) AS t2 LEFT JOIN (SELECT EMP0.ENAME, EMP0.SAL < 11 AS <, -1 * EMP0.SAL AS * FROM EMP AS EMP0) AS t3 ON t2.ENAME = t3.ENAME GROUP BY CASE WHEN t3.< THEN 11 ELSE t3.* END"
},
{
  "name": "testSemiJoinRuleFull",
  "q1": "SELECT DEPT.DEPTNO, DEPT.NAME FROM DEPT AS DEPT FULL JOIN (SELECT EMP.DEPTNO FROM EMP AS EMP WHERE EMP.SAL > 100 GROUP BY EMP.DEPTNO) AS t1 ON DEPT.DEPTNO = t1.DEPTNO",
  "q2": "SELECT DEPT0.DEPTNO, DEPT0.NAME FROM DEPT AS DEPT0 FULL JOIN (SELECT EMP0.DEPTNO FROM EMP AS EMP0 WHERE EMP0.SAL > 100 GROUP BY EMP0.DEPTNO) AS t5 ON DEPT0.DEPTNO = t5.DEPTNO"
},
{
  "name": "testSemiJoinRuleLeft",
  "q1": "SELECT DEPT.NAME FROM DEPT AS DEPT LEFT JOIN (SELECT EMP.DEPTNO FROM EMP AS EMP WHERE EMP.SAL > 100 GROUP BY EMP.DEPTNO) AS t1 ON DEPT.DEPTNO = t1.DEPTNO",
  "q2": "SELECT DEPT0.NAME FROM DEPT AS DEPT0"
},
{
  "name": "testExpandProjectInComposite",
  "q1": "SELECT EMP.EMPNO, (EMP.EMPNO, EMP.DEPTNO) IN (SELECT EMP0.EMPNO, EMP0.DEPTNO FROM EMP AS EMP0 WHERE EMP0.EMPNO < 20) AS D FROM EMP AS EMP",
  "q2": "SELECT EMP1.EMPNO, CASE WHEN t4.i IS NOT NULL THEN TRUE ELSE FALSE END AS D FROM EMP AS EMP1 LEFT JOIN (SELECT EMP2.EMPNO, EMP2.DEPTNO, TRUE AS i FROM EMP AS EMP2 WHERE EMP2.EMPNO < 20) AS t4 ON EMP1.EMPNO = t4.EMPNO AND EMP1.DEPTNO = t4.DEPTNO"
},
{
  "name": "testEmptyJoinLeft",
  "q1": "SELECT * FROM (SELECT * FROM EMP AS EMP WHERE FALSE) AS t LEFT JOIN DEPT AS DEPT ON t.DEPTNO = DEPT.DEPTNO",
  "q2": "SELECT * FROM (VALUES) AS t0"
},
{
  "name": "testReduceNestedCaseWhen",
  "q1": "SELECT EMP.SAL FROM EMP AS EMP WHERE CASE WHEN EMP.SAL = 1000 THEN CASE WHEN EMP.SAL = 1000 THEN NULL ELSE 1 END IS NULL ELSE CASE WHEN EMP.SAL = 2000 THEN NULL ELSE 1 END IS NULL END IS TRUE",
  "q2": "SELECT EMP0.SAL FROM EMP AS EMP0 WHERE CASE WHEN EMP0.SAL = 1000 THEN EMP0.SAL = 1000 ELSE EMP0.SAL = 2000 END"
},
{
  "name": "testTransitiveInferenceRightOuterJoin",
  "q1": "SELECT 1 FROM EMP AS EMP RIGHT JOIN (SELECT * FROM EMP AS EMP0 WHERE EMP0.DEPTNO > 9) AS t ON EMP.DEPTNO = t.DEPTNO WHERE EMP.DEPTNO > 7",
  "q2": "SELECT 1 FROM (SELECT * FROM EMP AS EMP1 WHERE EMP1.DEPTNO > 9) AS t2 RIGHT JOIN (SELECT * FROM EMP AS EMP2 WHERE EMP2.DEPTNO > 9) AS t3 ON t2.DEPTNO = t3.DEPTNO WHERE t2.DEPTNO > 7"
},
{
  "name": "testDistinctCountMixed2",
  "q1": "SELECT EMP.DEPTNO, COUNT(DISTINCT EMP.ENAME) AS CDE, COUNT(DISTINCT EMP.JOB, EMP.ENAME) AS CDJE, COUNT(DISTINCT EMP.DEPTNO, EMP.JOB) AS CDDJ, SUM(EMP.SAL) AS S FROM EMP AS EMP GROUP BY EMP.DEPTNO",
  "q2": "SELECT EMP0.DEPTNO, COUNT(EMP0.ENAME) AS CDE, COUNT(EMP0.JOB, EMP0.ENAME) AS CDJE, COUNT(EMP0.DEPTNO, EMP0.JOB) AS CDDJ, CAST(MIN(SUM(EMP0.SAL)) AS INTEGER) AS S FROM EMP AS EMP0 GROUP BY EMP0.DEPTNO"
},
{
  "name": "basePushAggThroughUnion",
  "q1": "SELECT t1.DEPTNO, t1.JOB, SUM(t1.U) FROM (SELECT EMP.EMPNO, EMP.ENAME, EMP.JOB, EMP.MGR, EMP.HIREDATE, EMP.SAL, EMP.COMM, EMP.DEPTNO, EMP.SLACKER, NULL AS U FROM EMP AS EMP UNION ALL SELECT EMP0.EMPNO, EMP0.ENAME, EMP0.JOB, EMP0.MGR, EMP0.HIREDATE, EMP0.SAL, EMP0.COMM, EMP0.DEPTNO, EMP0.SLACKER, NULL AS U FROM EMP AS EMP0) AS t1 GROUP BY t1.DEPTNO, t1.JOB",
  "q2": "SELECT t8.DEPTNO, t8.JOB, SUM(SUM(NULL)) FROM (SELECT EMP1.DEPTNO, EMP1.JOB, SUM(NULL) FROM EMP AS EMP1 GROUP BY EMP1.DEPTNO, EMP1.JOB UNION ALL SELECT EMP2.DEPTNO, EMP2.JOB, SUM(NULL) FROM EMP AS EMP2 GROUP BY EMP2.DEPTNO, EMP2.JOB) AS t8 GROUP BY t8.DEPTNO, t8.JOB"
},
{
  "name": "testExpandFilterIn3Value",
  "q1": "SELECT EMP.EMPNO FROM EMP AS EMP WHERE EMP.EMPNO < CASE WHEN EMP.DEPTNO IN (SELECT CASE WHEN TRUE THEN CAST(EMP0.DEPTNO AS INTEGER) ELSE NULL END FROM EMP AS EMP0 WHERE EMP0.EMPNO < 20) = TRUE THEN 10 WHEN EMP.DEPTNO IN (SELECT CASE WHEN TRUE THEN CAST(EMP1.DEPTNO AS INTEGER) ELSE NULL END FROM EMP AS EMP1 WHERE EMP1.EMPNO < 20) = FALSE THEN 20 ELSE 30 END",
  "q2": "SELECT EMP2.EMPNO FROM EMP AS EMP2, (SELECT COUNT(*) AS c, COUNT(CASE WHEN TRUE THEN CAST(EMP3.DEPTNO AS INTEGER) ELSE NULL END) AS ck FROM EMP AS EMP3 WHERE EMP3.EMPNO < 20) AS t7 LEFT JOIN (SELECT CASE WHEN TRUE THEN CAST(EMP4.DEPTNO AS INTEGER) ELSE NULL END, TRUE AS i FROM EMP AS EMP4 WHERE EMP4.EMPNO < 20 GROUP BY CASE WHEN TRUE THEN CAST(EMP4.DEPTNO AS INTEGER) ELSE NULL END, TRUE) AS t11 ON EMP2.DEPTNO = CASE WHEN TRUE THEN CAST(EMP4.DEPTNO AS INTEGER) ELSE NULL END WHERE EMP2.EMPNO < CASE WHEN CASE WHEN t7.c = 0 THEN FALSE WHEN t11.i IS NOT NULL THEN TRUE WHEN t7.ck < t7.c THEN NULL ELSE FALSE END = TRUE THEN 10 WHEN CASE WHEN t7.c = 0 THEN FALSE WHEN t11.i IS NOT NULL THEN TRUE WHEN t7.ck < t7.c THEN NULL ELSE FALSE END = FALSE THEN 20 ELSE 30 END"
},
{
  "name": "testSortUnionTranspose2",
  "q1": "SELECT * FROM (SELECT DEPT.NAME FROM DEPT AS DEPT UNION ALL SELECT DEPT0.NAME FROM DEPT AS DEPT0) AS t1 ORDER BY t1.NAME",
  "q2": "SELECT * FROM (SELECT DEPT1.NAME FROM DEPT AS DEPT1 ORDER BY DEPT1.NAME UNION ALL SELECT DEPT2.NAME FROM DEPT AS DEPT2 ORDER BY DEPT2.NAME) AS t7 ORDER BY t7.NAME"
},
{
  "name": "testSortUnionTranspose3",
  "q1": "SELECT * FROM (SELECT DEPT.NAME FROM DEPT AS DEPT UNION ALL SELECT DEPT0.NAME FROM DEPT AS DEPT0) AS t1 ORDER BY t1.NAME FETCH NEXT 0 ROWS ONLY",
  "q2": "SELECT * FROM (SELECT DEPT1.NAME FROM DEPT AS DEPT1 ORDER BY DEPT1.NAME FETCH NEXT 0 ROWS ONLY UNION ALL SELECT DEPT2.NAME FROM DEPT AS DEPT2 ORDER BY DEPT2.NAME FETCH NEXT 0 ROWS ONLY) AS t10 ORDER BY t10.NAME FETCH NEXT 0 ROWS ONLY"
},
{
  "name": "testTransitiveInferenceComplexPredicate",
  "q1": "SELECT 1 FROM (SELECT * FROM EMP AS EMP WHERE EMP.DEPTNO > 7 AND EMP.COMM = EMP.DEPTNO AND EMP.COMM + EMP.DEPTNO > EMP.COMM / 2) AS t INNER JOIN (SELECT * FROM EMP AS EMP0 WHERE EMP0.SAL = EMP0.DEPTNO) AS t0 ON t.DEPTNO = t0.DEPTNO",
  "q2": "SELECT 1 FROM (SELECT * FROM EMP AS EMP1 WHERE EMP1.DEPTNO > 7 AND EMP1.COMM = EMP1.DEPTNO AND EMP1.COMM + EMP1.DEPTNO > EMP1.COMM / 2) AS t2 INNER JOIN (SELECT * FROM (SELECT * FROM EMP AS EMP2 WHERE EMP2.SAL = EMP2.DEPTNO) AS t3 WHERE t3.DEPTNO > 7) AS t4 ON t2.DEPTNO = t4.DEPTNO"
},
{
  "name": "testExpandFilterScalar",
  "q1": "SELECT EMP.EMPNO FROM EMP AS EMP WHERE (((SELECT EMP0.DEPTNO FROM EMP AS EMP0 WHERE EMP0.EMPNO < 20))) < (((SELECT EMP1.DEPTNO FROM EMP AS EMP1 WHERE EMP1.EMPNO > 100))) OR EMP.SAL < 100",
  "q2": "SELECT EMP2.EMPNO FROM EMP AS EMP2 LEFT JOIN (SELECT SINGLE_VALUE(EMP3.DEPTNO) AS $f0 FROM EMP AS EMP3 WHERE EMP3.EMPNO < 20) AS t7 ON TRUE LEFT JOIN (SELECT SINGLE_VALUE(EMP4.DEPTNO) AS $f0 FROM EMP AS EMP4 WHERE EMP4.EMPNO > 100) AS t10 ON TRUE WHERE t7.$f0 < t10.$f0 OR EMP2.SAL < 100"
},
{
  "name": "testAlreadyFalseEliminatesFilter",
  "q1": "SELECT * FROM (VALUES  (1, 2)) AS t WHERE FALSE",
  "q2": "SELECT * FROM (VALUES) AS t1"
},
{
  "name": "basePushAggThroughUnion",
  "q1": "SELECT t.ENAME, MAX(t.MGR) FROM (SELECT * FROM EMP AS EMP UNION ALL SELECT * FROM EMP AS EMP0) AS t GROUP BY t.ENAME",
  "q2": "SELECT t6.ENAME, MAX(MAX(EMP2.MGR)) FROM (SELECT EMP1.ENAME, MAX(EMP1.MGR) FROM EMP AS EMP1 GROUP BY EMP1.ENAME UNION ALL SELECT EMP2.ENAME, MAX(EMP2.MGR) FROM EMP AS EMP2 GROUP BY EMP2.ENAME) AS t6 GROUP BY t6.ENAME"
},
{
  "name": "testPullConstantThroughUnion2",
  "q1": "SELECT 2, EMP.DEPTNO, EMP.JOB FROM EMP AS EMP UNION ALL SELECT 1, EMP0.DEPTNO, EMP0.JOB FROM EMP AS EMP0",
  "q2": "SELECT 2, EMP1.DEPTNO, EMP1.JOB FROM EMP AS EMP1 UNION ALL SELECT 1, EMP2.DEPTNO, EMP2.JOB FROM EMP AS EMP2"
},
{
  "name": "testPullConstantThroughUnion3",
  "q1": "SELECT 2, 3 FROM EMP AS EMP UNION ALL SELECT 2, 3 FROM EMP AS EMP0",
  "q2": "SELECT 2, 3 FROM (SELECT 2 FROM EMP AS EMP1 UNION ALL SELECT 2 FROM EMP AS EMP2) AS t6"
},
{
  "name": "testPushProjectPastRightJoin",
  "q1": "SELECT COUNT(*), CASE WHEN EMP.SAL < 11 THEN 11 ELSE -1 * EMP.SAL END FROM EMP AS EMP RIGHT JOIN BONUS AS BONUS ON EMP.ENAME = BONUS.ENAME GROUP BY CASE WHEN EMP.SAL < 11 THEN 11 ELSE -1 * EMP.SAL END",
  "q2": "SELECT COUNT(*), CASE WHEN t2.< THEN 11 ELSE t2.* END FROM (SELECT EMP0.ENAME, EMP0.SAL < 11 AS <, -1 * EMP0.SAL AS * FROM EMP AS EMP0) AS t2 RIGHT JOIN (SELECT BONUS0.ENAME FROM BONUS AS BONUS0) AS t3 ON t2.ENAME = t3.ENAME GROUP BY CASE WHEN t2.< THEN 11 ELSE t2.* END"
},
{
  "name": "testMergeUnionMixed",
  "q1": "SELECT * FROM (SELECT * FROM EMP AS EMP WHERE EMP.DEPTNO = 10 UNION SELECT * FROM EMP AS EMP0 WHERE EMP0.DEPTNO = 20) AS t1 UNION ALL SELECT * FROM EMP AS EMP1 WHERE EMP1.DEPTNO = 30",
  "q2": "SELECT * FROM (SELECT * FROM EMP AS EMP2 WHERE EMP2.DEPTNO = 10 UNION SELECT * FROM EMP AS EMP3 WHERE EMP3.DEPTNO = 20) AS t6 UNION ALL SELECT * FROM EMP AS EMP4 WHERE EMP4.DEPTNO = 30"
}
]